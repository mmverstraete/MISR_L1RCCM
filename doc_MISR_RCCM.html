<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
    "http://www.w3.org/TR/html4/strict.dtd">
<html lang="en">
   <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>Documentation for the IDL routines in project MISR_RCCM</title>
   </head>
<body>
<h1>Documentation for the IDL routines in project MISR_RCCM</h1>
<h2>count_rccm_miss</h2>
<ul>
<li><p><strong>Purpose:</strong> This function counts the number of missing <span class="smallcaps">RCCM</span> pixel values found in each of the 9 cameras of all available <span class="smallcaps">Orbits</span> for the specified <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span> and <span class="smallcaps">Block</span>, and saves the results in a plain <code>ASCII</code> text file.</p></li>
<li><p><strong>Algorithm:</strong> This function relies on the <code>IDL</code> functions <code>rccm_0</code> and <code>rccm_1</code> to read the <span class="smallcaps">RCCM</span> files for each of the available <span class="smallcaps">Orbits</span> and to distinguish genuinely missing values from swath edge and obscured values. This requires loading the corresponding <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> Radiance files to locate those edge and obscured values.</p></li>
<li><p><strong>Syntax:</strong> <code>rc = count_rccm_miss(misr_path, misr_block, $</code><br />
<code>L1B2_FOLDER = l1b2_folder, L1B2_VERSION = l1b2_version, $</code><br />
<code>RCCM_FOLDER = rccm_folder, RCCM_VERSION = rccm_version, $</code><br />
<code>OUT_FOLDER = out_folder, VERBOSE = verbose, $</code><br />
<code>DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>misr_path {INT} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span> number.</p></li>
<li><p><code>misr_block {INT} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Block</span> number.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>L1B2_FOLDER = l1b2_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the folder containing the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> files, if they are not located in the default location.</p></li>
<li><p><code>L1B2_VERSION = l1b2_version {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The <span class="smallcaps">L1B2</span> version identifier to use instead of the default value.</p></li>
<li><p><code>RCCM_FOLDER = rccm_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the folder containing the <span class="smallcaps">MISR</span> <span class="smallcaps">RCCM</span> files, if they are not located in the default location.</p></li>
<li><p><code>RCCM_VERSION = rccm_version {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The <span class="smallcaps">MISR</span> <span class="smallcaps">RCCM</span> version identifier to use instead of the default value.</p></li>
<li><p><code>OUT_FOLDER = out_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the folder containing the output file(s).</p></li>
<li><p><code>VERBOSE = verbose {INT} [I] (Default value: 0):</code> Flag to enable (&gt; 0) or skip (0) outputting messages on the console:</p>
<ul>
<li><p>If <code>verbose &gt; 0</code>, messages inform the user about progress in the execution of time-consuming routines, or the location of output files (e.g., log, map, plot, etc.);</p></li>
<li><p>If <code>verbose &gt; 1</code>, messages record entering and exiting the routine; and</p></li>
<li><p>If <code>verbose &gt; 2</code>, messages provide additional information about intermediary results.</p></li>
</ul></li>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided in the call. The output file containing the statistics on the number of missing values in each <span class="smallcaps">RCCM</span> file is saved in the default or designated folder.</p></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The output file may be inexistent, incomplete or incorrect.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: The input positional parameter <code>misr_path</code> is invalid.</p></li>
<li><p>Error 120: The input positional parameter <code>misr_block</code> is invalid.</p></li>
<li><p>Error 199: An exception condition occurred in <code>set_roots_vers.pro</code>.</p></li>
<li><p>Error 200: An exception condition occurred in function <code>path2str.pro</code>.</p></li>
<li><p>Error 210: An exception condition occurred in function <code>block2str.pro</code>.</p></li>
<li><p>Error 299: The computer is not recognized and at least one of the optional input keyword parameters <code>l1b2_folder</code>, <code>rccm_folder</code>, <code>out_folder</code> is not specified.</p></li>
<li><p>Error 300: The input folder <code>l1b2_path</code> is not found, not a directory or not readable.</p></li>
<li><p>Error 310: The input folder <code>rccm_path</code> is not found, not a directory or not readable.</p></li>
<li><p>Error 400: The output folder <code>out_fpath</code> is not writable.</p></li>
<li><p>Error 500: The <code>gm_orbits</code> and <code>rc_orbits</code> arrays have no <span class="smallcaps">Orbit</span> number in common.</p></li>
<li><p>Error 510: An exception condition occurred in function <code>heap_l1b2_block.pro</code>.</p></li>
<li><p>Error 600: An exception condition occurred in the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> routine<br />
<code>MTK_SETREGION_BY_PATH_BLOCKRANGE</code>.</p></li>
<li><p>Error 610: An exception condition occurred in the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> routine<br />
<code>MTK_MAKE_FILENAME</code>.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>MISR Toolkit</code></p></li>
<li><p><code>cgSetIntersection (David W. Fanning, Coyote Library)</code></p></li>
<li><p><code>block2str.pro</code></p></li>
<li><p><code>chk_misr_block.pro</code></p></li>
<li><p><code>chk_misr_path.pro</code></p></li>
<li><p><code>find_rccm_files.pro</code></p></li>
<li><p><code>force_path_sep.pro</code></p></li>
<li><p><code>heap_l1b2_block.pro</code></p></li>
<li><p><code>is_numeric.pro</code></p></li>
<li><p><code>is_readable_dir.pro</code></p></li>
<li><p><code>is_writable_dir.pro</code></p></li>
<li><p><code>mk_rccm0.pro</code></p></li>
<li><p><code>mk_rccm1.pro</code></p></li>
<li><p><code>orbit2date.pro</code></p></li>
<li><p><code>path2str.pro</code></p></li>
<li><p><code>set_roots_vers.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
<li><p><code>today.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> Because the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> files need to be read to process the <span class="smallcaps">RCCM</span> files, this function is very time consuming: it can take over an hour to generate the statistics for a single <span class="smallcaps">Block</span> over the entire mission period. Set the optional input keyword parameter <code>VERBOSE</code> to <code>2</code> to generate an intermediary progress report on the console each time 50 <span class="smallcaps">Orbits</span> have been processed.</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>IDL&gt; misr_path = 167
IDL&gt; misr_block = 100
IDL&gt; rc = count_rccm_miss(misr_path, misr_block)
IDL&gt; PRINT, rc
       0</code></pre></li>
<li><p><strong>References:</strong></p>
<ul>
<li><p>Michel Verstraete, Linda Hunt, Hugo De Lemos and Larry Di Girolamo (2019) <em>Replacing Missing Values in the Standard MISR Radiometric Camera-by-Camera Cloud Mask (RCCM) Data Product</em>, <code>Earth System Science Data Discussions</code>, Vol. 2019, p. 1&#8211;18, available from <a href="https://www.earth-syst-sci-data-discuss.net/essd-2019-77/" class="uri">https://www.earth-syst-sci-data-discuss.net/essd-2019-77/</a> (DOI: 10.5194/essd-2019-77).</p></li>
</ul></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2019&#8211;04&#8211;30: Version 1.0 &#8212; Initial release.</p></li>
<li><p>2019&#8211;05&#8211;01: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;05&#8211;04: Version 2.01 &#8212; Update the code to report the specific error message of MTK routines.</p></li>
<li><p>2019&#8211;05&#8211;07: Version 2.15 &#8212; Software version described in the preprint published in ESSD Discussions mentioned above.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the use of <code>verbose</code> and the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
</ul></li>
</ul>
<h2>diag_rccm</h2>
<ul>
<li><p><strong>Purpose:</strong> This function collects metadata and basic statistics about the contents of a single <span class="smallcaps">MISR</span> <span class="smallcaps">Block</span> within each of the 9 <span class="smallcaps">MISR</span> RCCM files for the specified <span class="smallcaps">Path</span>, <span class="smallcaps">Orbit</span>, and <span class="smallcaps">Block</span>, and optionally saves these results into 9 text files and 9 corresponding <code>IDL</code> <code>SAVE</code> files.</p></li>
<li><p><strong>Algorithm:</strong> This function inspects the contents of the 9 <span class="smallcaps">MISR</span> RCCM files and reports on the numbers of high-confidence cloud, low-confidence cloud, low confidence clear and high-confidence clear pixels, as well as on the number of glitter-contaminated pixels and on the tests used to derive those cloudiness levels.</p></li>
<li><p><strong>Syntax:</strong> <code>rc = diag_rccm(misr_path, misr_orbit, misr_block, $</code><br />
<code>RCCM_FOLDER = rccm_folder, RCCM_VERSION = rccm_version, $</code><br />
<code>LOG_IT = log_it, LOG_FOLDER = log_folder, $</code><br />
<code>SAVE_IT = save_it, SAVE_FOLDER = save_folder, $</code><br />
<code>VERBOSE = verbose, DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>misr_path {INTEGER} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span> number.</p></li>
<li><p><code>misr_orbit {LONG} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Orbit</span> number.</p></li>
<li><p><code>misr_block {INTEGER} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Block</span> number.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>RCCM_FOLDER = rccm_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the folder containing the <span class="smallcaps">MISR</span> <span class="smallcaps">RCCM</span> files, if they are not located in the default location.</p></li>
<li><p><code>RCCM_VERSION = rccm_version {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The <span class="smallcaps">MISR</span> <span class="smallcaps">RCCM</span> version identifier to use instead of the default value.</p></li>
<li><p><code>LOG_IT = log_it {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) generating a log file.</p></li>
<li><p><code>LOG_FOLDER = log_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the output folder containing the processing log.</p></li>
<li><p><code>SAVE_IT = save_it {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) saving the results in a savefile.</p></li>
<li><p><code>SAVE_FOLDER = save_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the output folder containing the savefile.</p></li>
<li><p><code>VERBOSE = verbose {INT} [I] (Default value: 0):</code> Flag to enable (&gt; 0) or skip (0) outputting messages on the console:</p>
<ul>
<li><p>If <code>verbose &gt; 0</code>, messages inform the user about progress in the execution of time-consuming routines, or the location of output files (e.g., log, map, plot, etc.);</p></li>
<li><p>If <code>verbose &gt; 1</code>, messages record entering and exiting the routine; and</p></li>
<li><p>If <code>verbose &gt; 2</code>, messages provide additional information about intermediary results.</p></li>
</ul></li>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided in the call. The output log and save files are saved in the designated or default folders.</p></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The output log and save files may be inexistent, incomplete or incorrect.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Warning 98: The computer has not been recognized by the function<br />
<code>get_host_info.pro</code>.</p></li>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: Input argument <code>misr_path</code> is invalid.</p></li>
<li><p>Error 120: Input argument <code>misr_orbit</code> is invalid.</p></li>
<li><p>Error 122: The input positional parameter <code>misr_orbit</code> is inconsistent with the input positional parameter <code>misr_path</code>.</p></li>
<li><p>Error 124: An exception condition occurred in <code>is_frompath.pro</code>.</p></li>
<li><p>Error 130: Input argument <code>misr_block</code> is invalid.</p></li>
<li><p>Error 199: An exception condition occurred in <code>set_roots_vers.pro</code>.</p></li>
<li><p>Error 200: An exception condition occurred in function <code>path2str.pro</code>.</p></li>
<li><p>Error 210: An exception condition occurred in function <code>orbit2str.pro</code>.</p></li>
<li><p>Error 220: An exception condition occurred in function <code>block2str.pro</code>.</p></li>
<li><p>Error 230: An exception condition occurred in function <code>orbit2date.pro</code>.</p></li>
<li><p>Error 299: The computer is not recognized and at least one of the optional input keyword parameters <code>rccm_folder</code>, <code>log_folder</code>, <code>save_folder</code> is not specified.</p></li>
<li><p>Error 300: An exception condition occurred in function <code>find_rccm_files</code>.</p></li>
<li><p>Error 400: The output folder <code>log_fpath</code> is unwritable.</p></li>
<li><p>Error 410: The output folder <code>save_fpath</code> is unwritable.</p></li>
<li><p>Error 600: An exception condition occurred in the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> routine<br />
<code>MTK_FILE_VERSION</code>.</p></li>
<li><p>Error 610: An exception condition occurred in the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> routine<br />
<code>MTK_SETREGION_BY_PATH_BLOCKRANGE</code>.</p></li>
<li><p>Error 620: An exception condition occurred in the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> routine<br />
<code>MTK_FILE_TO_GRIDLIST</code>.</p></li>
<li><p>Error 630: An exception condition occurred in the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> routine<br />
<code>MTK_FILE_GRID_TO_FIELDLIST</code>.</p></li>
<li><p>Error 640: An exception condition occurred in the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> routine<br />
<code>MTK_READDATA</code>.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>MISR Toolkit</code></p></li>
<li><p><code>block2str.pro</code></p></li>
<li><p><code>chk_misr_block.pro</code></p></li>
<li><p><code>chk_misr_orbit.pro</code></p></li>
<li><p><code>chk_misr_path.pro</code></p></li>
<li><p><code>find_rccm_files.pro</code></p></li>
<li><p><code>force_path_sep.pro</code></p></li>
<li><p><code>get_host_info.pro</code></p></li>
<li><p><code>is_frompath.pro</code></p></li>
<li><p><code>is_numeric.pro</code></p></li>
<li><p><code>is_writable_dir.pro</code></p></li>
<li><p><code>oom.pro</code></p></li>
<li><p><code>orbit2date.pro</code></p></li>
<li><p><code>orbit2str.pro</code></p></li>
<li><p><code>path2str.pro</code></p></li>
<li><p><code>set_roots_vers.pro</code></p></li>
<li><p><code>today.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> The input keyword parameters <code>log_it</code> and <code>save_it</code> are provided to generate the desired outputs selectively. Deselecting some of them may accelerate the processing, but if neither of them are set, then no output will be saved either.</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>IDL&gt; misr_path = 168
IDL&gt; misr_orbit = 65487
IDL&gt; misr_block = 111
IDL&gt; log_it = 1
IDL&gt; save_it = 1
IDL&gt; verbose = 1
IDL&gt; debug = 1
IDL&gt; rc = diag_rccm(misr_path, misr_orbit, misr_block, $
   LOG_IT = log_it, LOG_FOLDER = log_folder, $
   SAVE_IT = save_it, SAVE_FOLDER = save_folder, $
   VERBOSE = verbose, DEBUG = debug, EXCPT_COND = excpt_cond)
Saved ~/MISR_HR/Outcomes/GM-P168-O065487-B111/RCCM/
   Save_RCCM_diag_GM-P168-O065487-B111-AA_2012-04-10_2019-02-19.sav
Saved ~/MISR_HR/Outcomes/GM-P168-O065487-B111/RCCM/
   Log_RCCM_diag_GM-P168-O065487-B111-AA_2012-04-10_2019-02-19.txt
...
Saved ~/MISR_HR/Outcomes/GM-P168-O065487-B111/RCCM/
   Save_RCCM_diag_GM-P168-O065487-B111-DF_2012-04-10_2019-02-19.sav
Saved ~/MISR_HR/Outcomes/GM-P168-O065487-B111/RCCM/
   Log_RCCM_diag_GM-P168-O065487-B111-DF_2012-04-10_2019-02-19.txt</code></pre></li>
<li><p><strong>References:</strong></p>
<ul>
<li><p>Michel Verstraete, Linda Hunt, Hugo De Lemos and Larry Di Girolamo (2019) <em>Replacing Missing Values in the Standard MISR Radiometric Camera-by-Camera Cloud Mask (RCCM) Data Product</em>, <code>Earth System Science Data Discussions</code>, Vol. 2019, p. 1&#8211;18, available from <a href="https://www.earth-syst-sci-data-discuss.net/essd-2019-77/" class="uri">https://www.earth-syst-sci-data-discuss.net/essd-2019-77/</a> (DOI: 10.5194/essd-2019-77).</p></li>
</ul></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2019&#8211;02&#8211;05: Version 1.0 &#8212; Initial release.</p></li>
<li><p>2019&#8211;02&#8211;06: Version 1.1 &#8212; Initial public release, following the stricter coding and documentation standards.</p></li>
<li><p>2019&#8211;02&#8211;18: Version 2.00 &#8212; Implement new algorithm (multiple scans of the input cloud mask) to minimize artifacts in the filled areas.</p></li>
<li><p>2019&#8211;02&#8211;28: Version 2.01 &#8212; Documentation update.</p></li>
<li><p>2019&#8211;03&#8211;28: Version 2.10 &#8212; Update the handling of the optional input keyword parameter <code>VERBOSE</code> and generate the software version consistent with the published documentation.</p></li>
<li><p>2019&#8211;05&#8211;02: Version 2.11 &#8212; Bug fix: Encapsulate folder and file creation in <code>IF</code> statements.</p></li>
<li><p>2019&#8211;05&#8211;04: Version 2.12 &#8212; Update the code to report the specific error message of MTK routines.</p></li>
<li><p>2019&#8211;05&#8211;07: Version 2.15 &#8212; Software version described in the preprint published in ESSD Discussions mentioned above.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the use of <code>verbose</code> and the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
</ul></li>
</ul>
<h2>find_missing_rccm_files</h2>
<ul>
<li><p><strong>Purpose:</strong> This function inspects the available <span class="smallcaps">MISR</span> <span class="smallcaps">RCCM</span> files for the specified <span class="smallcaps">Path</span> between the indicated dates, and reports on missing <span class="smallcaps">Orbits</span> within that period.</p></li>
<li><p><strong>Algorithm:</strong> This function relies on the <span class="smallcaps">MISR</span> Toolkit to generate a list of missing <span class="smallcaps">RCCM</span> <span class="smallcaps">Orbits</span> for the specified <span class="smallcaps">Path</span> that occur between the <code>from_date</code> and the <code>until_date</code> dates, inclusive. If the optional input keyword parameter <code>log_it</code> is set, it generates a log file indicating the <span class="smallcaps">Orbits</span> for which the requested products and versions are missing, and saves it in the specified or default folder.</p></li>
<li><p><strong>Syntax:</strong> <code>rc = find_missing_rccm_files(misr_path, n_missing_rccm_files, $</code><br />
<code>FROM_DATE = from_date, UNTIL_DATE = until_date, n_missing_rccm_files $</code><br />
<code>RCCM_FOLDER = rccm_folder, RCCM_VERSION = rccm_version, $</code><br />
<code>LOG_IT = log_it, LOG_FOLDER = log_folder, $</code><br />
<code>VERBOSE = verbose, DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>misr_path {INT} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span> number.</p></li>
<li><p><code>n_missing_rccm_files {LONG} [O]:</code> The number of missing <span class="smallcaps">MISR</span> Global Mode RCCM files.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>RCCM_FOLDER = rccm_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the folder containing the <span class="smallcaps">MISR</span> <span class="smallcaps">RCCM</span> files, if they are not located in the default location.</p></li>
<li><p><code>RCCM_VERSION = rccm_version {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The <span class="smallcaps">RCCM</span> version identifier to use instead of the default value.</p></li>
<li><p><code>LOG_IT = log_it {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) generating a log file.</p></li>
<li><p><code>LOG_FOLDER = log_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the output folder containing the processing log.</p></li>
<li><p><code>VERBOSE = verbose {INT} [I] (Default value: 0):</code> Flag to enable (&gt; 0) or skip (0) outputting messages on the console:</p>
<ul>
<li><p>If <code>verbose &gt; 0</code>, messages inform the user about progress in the execution of time-consuming routines, or the location of output files (e.g., log, map, plot, etc.);</p></li>
<li><p>If <code>verbose &gt; 1</code>, messages record entering and exiting the routine; and</p></li>
<li><p>If <code>verbose &gt; 2</code>, messages provide additional information about intermediary results.</p></li>
</ul></li>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided in the call. The output positional parameter <code>n_missing_rccm_files</code> reports on the number of missing files in the designated or default folder, between the specified dates. A log file is saved if the input keyword parameter <code>LOG_IT</code> is set.</p></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The output positional parameter <code>n_missing_rccm_files</code> may be undefined, incomplete or incorrect.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: The input positional parameter <code>misr_path</code> is invalid.</p></li>
<li><p>Error 199: An exception condition occurred in <code>set_roots_vers.pro</code>.</p></li>
<li><p>Error 200: An exception condition occurred in function <code>path2str.pro</code>.</p></li>
<li><p>Error 210: An exception condition occurred in function <code>chk_ymddate.pro</code>.</p></li>
<li><p>Error 220: An exception condition occurred in function <code>chk_ymddate.pro</code>.</p></li>
<li><p>Error 299: The computer is not recognized and at least one of the optional input keyword parameters <code>rccm_folder</code>, <code>log_folder</code> is not specified.</p></li>
<li><p>Error 300: An exception condition occurred in function <code>set_rccm_folder.pro</code>.</p></li>
<li><p>Error 400: The output folder <code>log_fpath</code> is unwritable.</p></li>
<li><p>Error 500: An exception condition occurred in function <code>find_orbits_paths_dates.pro</code>.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>chk_misr_path.pro</code></p></li>
<li><p><code>chk_ymddate.pro</code></p></li>
<li><p><code>find_orbits_paths_dates.pro</code></p></li>
<li><p><code>force_path_sep.pro</code></p></li>
<li><p><code>get_host_info.pro</code></p></li>
<li><p><code>is_numeric.pro</code></p></li>
<li><p><code>is_writable.pro</code></p></li>
<li><p><code>match2.pro</code> [from IDL AstroLib]</p></li>
<li><p><code>path2str.pro</code></p></li>
<li><p><code>set_rccm_folder.pro</code></p></li>
<li><p><code>set_misr_specs.pro</code></p></li>
<li><p><code>set_roots_vers.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
<li><p><code>today.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong> None.</p></li>
<li><p><strong>Examples:</strong></p>
<pre><code>IDL&gt; misr_path = 168
IDL&gt; from_date = &#39;&#39;
IDL&gt; until_date = &#39;2018-12-31&#39;
IDL&gt; log_it = 1
IDL&gt; verbose = 1
IDL&gt; debug = 1
IDL&gt; rc = find_missing_rccm_files(misr_path, n_missing_rccm_files, $
   FROM_DATE = from_date, UNTIL_DATE = until_date, $
   RCCM_FOLDER = rccm_folder, $
   RCCM_VERSION = rccm_version, LOG_IT = log_it, $
   LOG_FOLDER = log_folder, VERBOSE = verbose, $
   DEBUG = debug, EXCPT_COND = excpt_cond)
IDL&gt; PRINT, rc
      0</code></pre></li>
<li><p><strong>References:</strong></p>
<ul>
<li><p>Michel Verstraete, Linda Hunt, Hugo De Lemos and Larry Di Girolamo (2019) <em>Replacing Missing Values in the Standard MISR Radiometric Camera-by-Camera Cloud Mask (RCCM) Data Product</em>, <code>Earth System Science Data Discussions</code>, Vol. 2019, p. 1&#8211;18, available from <a href="https://www.earth-syst-sci-data-discuss.net/essd-2019-77/" class="uri">https://www.earth-syst-sci-data-discuss.net/essd-2019-77/</a> (DOI: 10.5194/essd-2019-77).</p></li>
</ul></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2019&#8211;05&#8211;10: Version 1.0 &#8212; Initial public release.</p></li>
<li><p>2019&#8211;05&#8211;12: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;05&#8211;07: Version 2.15 &#8212; Software version described in the preprint published in ESSD Discussions mentioned above.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the use of <code>verbose</code> and the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
</ul></li>
</ul>
<h2>find_rccm_files</h2>
<ul>
<li><p><strong>Purpose:</strong> This function provides the file specifications (path + names) of the 9 <span class="smallcaps">MISR</span> <span class="smallcaps">L1</span> Radiometric Camera-by-camera Cloud Mask (RCCM) files corresponding to the given <code>misr_path</code> and <code>misr_orbit</code>, if they are available in the expected folder.</p></li>
<li><p><strong>Algorithm:</strong> This function reports the file specifications (path + names) of the 9 <span class="smallcaps">MISR</span> <span class="smallcaps">L1</span> RCCM files for the specified <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span> and <span class="smallcaps">Orbit</span> in the expected folder and verifies that they are readable.</p></li>
<li><p><strong>Syntax:</strong> <code>rc = find_rccm_files(misr_path, misr_orbit, rccm_files, $</code><br />
<code>RCCM_FOLDER = rccm_folder, RCCM_VERSION = rccm_version, $</code><br />
<code>VERBOSE = verbose, DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>misr_path {INT} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span> number.</p></li>
<li><p><code>misr_orbit {LONG} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Orbit</span> number.</p></li>
<li><p><code>rccm_files {STRING array} [O]:</code> The file specifications (path and filenames) of the 9 <span class="smallcaps">MISR</span> <span class="smallcaps">L1</span> RCCM files for the specified <code>misr_path</code> and <code>misr_orbit</code>.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>RCCM_FOLDER = rccm_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the folder containing the <span class="smallcaps">MISR</span> <span class="smallcaps">RCCM</span> files, if they are not located in the default location.</p></li>
<li><p><code>RCCM_VERSION = rccm_version {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The <span class="smallcaps">MISR</span> <span class="smallcaps">RCCM</span> version identifier to use instead of the default value.</p></li>
<li><p><code>VERBOSE = verbose {INT} [I] (Default value: 0):</code> Flag to enable (&gt; 0) or skip (0) outputting messages on the console:</p>
<ul>
<li><p>If <code>verbose &gt; 0</code>, messages inform the user about progress in the execution of time-consuming routines, or the location of output files (e.g., log, map, plot, etc.);</p></li>
<li><p>If <code>verbose &gt; 1</code>, messages record entering and exiting the routine; and</p></li>
<li><p>If <code>verbose &gt; 2</code>, messages provide additional information about intermediary results.</p></li>
</ul></li>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> was set and if the optional output keyword parameter <code>EXCPT_COND</code> was provided in the call. The output positional parameter <code>rccm_files</code> contains the specifications of the 9 <span class="smallcaps">MISR</span> RCCM files for the specified <span class="smallcaps">Path</span> and <span class="smallcaps">Orbit</span>.</p></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> was set and if the optional output keyword parameter <code>EXCPT_COND</code> was provided. The output positional parameter <code>rccm_files</code> may be inexistent, incomplete or incorrect.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: Input argument <code>misr_path</code> is invalid.</p></li>
<li><p>Error 120: Input argument <code>misr_orbit</code> is invalid.</p></li>
<li><p>Error 122: The input positional parameter <code>misr_orbit</code> is inconsistent with the input positional parameter <code>misr_path</code>.</p></li>
<li><p>Error 124: An exception condition occurred in <code>is_frompath.pro</code>.</p></li>
<li><p>Error 199: An exception condition occurred in <code>set_roots_vers.pro</code>.</p></li>
<li><p>Error 200: An exception condition occurred in function <code>path2str.pro</code>.</p></li>
<li><p>Error 210: An exception condition occurred in function <code>orbit2str.pro</code>.</p></li>
<li><p>Error 300: The input folder <code>rccm_path</code> is not found, not a directory or not readable.</p></li>
<li><p>Error 310: The input folder <code>rccm_path</code> does not contain any <span class="smallcaps">L1</span> RCCM files for selected <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span> and <span class="smallcaps">Orbit</span>.</p></li>
<li><p>Error 320: The input folder <code>rccm_path</code> contains fewer than 9 <span class="smallcaps">L1</span> RCCM files for selected <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span> and <span class="smallcaps">Orbit</span>.</p></li>
<li><p>Error 330: The input folder <code>rccm_path</code> contains more than 9 <span class="smallcaps">L1</span> RCCM files for selected <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span> and <span class="smallcaps">Orbit</span>.</p></li>
<li><p>Error 340: One of the <span class="smallcaps">MISR</span> <span class="smallcaps">L1</span> RCCM files in the input folder <code>rccm_path</code> is not readable.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>chk_misr_orbit.pro</code></p></li>
<li><p><code>chk_misr_path.pro</code></p></li>
<li><p><code>force_path_sep.pro</code></p></li>
<li><p><code>is_frompath.pro</code></p></li>
<li><p><code>is_numeric.pro</code></p></li>
<li><p><code>is_readable_dir.pro</code></p></li>
<li><p><code>is_readable_file.pro</code></p></li>
<li><p><code>orbit2str.pro</code></p></li>
<li><p><code>path2str.pro</code></p></li>
<li><p><code>set_misr_specs.pro</code></p></li>
<li><p><code>set_roots_vers.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> This function assumes that the folder <code>rccm_path</code>, defined either by default or by the input keyword parameter <code>l1b2_folder</code>, contains full <span class="smallcaps">Orbit</span>s, i.e., that files contain data for all <span class="smallcaps">Block</span>s. Exception condition <code>330</code> may be triggered by the presence of multiple subsetted files for the same <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span> and <span class="smallcaps">Orbit</span>.</p></li>
<li><p><strong>Note 2:</strong> The <span class="smallcaps">RCCM</span> file specifications are provided in the native <span class="smallcaps">MISR</span> camera order, i.e., from DF to DA.</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>IDL&gt; misr_path = 168
IDL&gt; misr_orbit = 68050
IDL&gt; rccm_folder = &#39;&#39;
IDL&gt; rccm_version = &#39;&#39;
IDL&gt; debug = 1
IDL&gt; rc = find_rccm_files(misr_path, misr_orbit, $
   rccm_files, RCCM_FOLDER = rccm_folder, $
   RCCM_VERSION = rccm_version, $
   DEBUG = debug, EXCPT_COND = excpt_cond)
IDL&gt; PRINT, rccm_files
/Volumes/.../MISR_AM1_GRP_RCCM_GM_P168_O068050_DF_F04_0025.hdf
/Volumes/.../MISR_AM1_GRP_RCCM_GM_P168_O068050_CF_F04_0025.hdf
/Volumes/.../MISR_AM1_GRP_RCCM_GM_P168_O068050_BF_F04_0025.hdf
/Volumes/.../MISR_AM1_GRP_RCCM_GM_P168_O068050_AF_F04_0025.hdf
/Volumes/.../MISR_AM1_GRP_RCCM_GM_P168_O068050_AN_F04_0025.hdf
/Volumes/.../MISR_AM1_GRP_RCCM_GM_P168_O068050_AA_F04_0025.hdf
/Volumes/.../MISR_AM1_GRP_RCCM_GM_P168_O068050_BA_F04_0025.hdf
/Volumes/.../MISR_AM1_GRP_RCCM_GM_P168_O068050_CA_F04_0025.hdf
/Volumes/.../MISR_AM1_GRP_RCCM_GM_P168_O068050_DA_F04_0025.hdf</code></pre></li>
<li><p><strong>References:</strong></p>
<ul>
<li><p>Michel Verstraete, Linda Hunt, Hugo De Lemos and Larry Di Girolamo (2019) <em>Replacing Missing Values in the Standard MISR Radiometric Camera-by-Camera Cloud Mask (RCCM) Data Product</em>, <code>Earth System Science Data Discussions</code>, Vol. 2019, p. 1&#8211;18, available from <a href="https://www.earth-syst-sci-data-discuss.net/essd-2019-77/" class="uri">https://www.earth-syst-sci-data-discuss.net/essd-2019-77/</a> (DOI: 10.5194/essd-2019-77).</p></li>
</ul></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2018&#8211;12&#8211;30: Version 1.0 &#8212; Initial public release.</p></li>
<li><p>2019&#8211;01&#8211;30: Version 1.1 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;02&#8211;02: Version 1.2 &#8212; Delete unused variable <code>pob_str</code>.</p></li>
<li><p>2019&#8211;02&#8211;05: Version 1.3 &#8212; Reorganize the <span class="smallcaps">MISR</span> <span class="smallcaps">RCCM</span> functions.</p></li>
<li><p>2019&#8211;02&#8211;18: Version 2.00 &#8212; Implement new algorithm (multiple scans of the input cloud mask) to minimize artifacts in the filled areas.</p></li>
<li><p>2019&#8211;02&#8211;24: Version 2.01 &#8212; Documentation update.</p></li>
<li><p>2019&#8211;03&#8211;28: Version 2.10 &#8212; Sort the <span class="smallcaps">RCCM</span> files in the native <span class="smallcaps">MISR</span> order on output; update the handling of the optional input keyword parameter <code>VERBOSE</code> and generate the software version consistent with the published documentation.</p></li>
<li><p>2019&#8211;05&#8211;07: Version 2.15 &#8212; Software version described in the preprint published in ESSD Discussions mentioned above.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the use of <code>verbose</code> and the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
</ul></li>
</ul>
<h2>fix_rccm</h2>
<ul>
<li><p><strong>Purpose:</strong> This function generates a clean version of the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> Georectified Radiance Product (GRP) Radiometric Camera-by-camera Cloud Mask (RCCM) data product with edge and obscured pixels duly flagged and missing values replaced by reasonable estimates. It also optionally permits to document the performance of the process.</p></li>
<li><p><strong>Algorithm:</strong> This function replaces missing values in the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> Radiometric Camera-by-camera Cloud Mask (RCCM) data product by reasonable estimates. Metadata on the <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span>, <span class="smallcaps">Orbit</span> and <span class="smallcaps">Block</span> to process, and <span class="smallcaps">L1B2</span> Georectified Radiance Product (GRP) data are obtained through pointers to the heap variables <code>misr_ptr</code> and <code>radrd_ptr</code>, respectively. The RCCM products are read from the input positional parameter <code>rccm_files</code>. For each of the 9 cameras, this replacement process is executed in 4 steps:</p>
<ul>
<li><p>Function <code>mk_rccm0.pro</code> reads the standard RCCM data from files,</p></li>
<li><p>Function <code>mk_rccm1.pro</code> flags unobservable (obscured and edge) pixels by importing that information from the associated Radiance product,</p></li>
<li><p>Function <code>mk_rccm2.pro</code> replaces missing values by cloudiness estimates derived from the 2 closest neighboring cameras wherever they record identical conditions, and</p></li>
<li><p>Function <code>mk_rccm3.pro</code> replaces any remaining missing values on the basis of cloudiness conditions in their immediate neighborhood.</p></li>
</ul>
<p>This function also allows the user to artificially introduce missing data for the purpose of documenting the performance of the replacement process.</p></li>
<li><p><strong>Syntax:</strong> <code>rc = fix_rccm(misr_ptr, radrd_ptr, rccm_files, rccm, $</code><br />
<code>RCCM_FOLDER = rccm_folder, RCCM_VERSION = rccm_version, $</code><br />
<code>TEST_ID = test_id, FIRST_LINE = first_line, LAST_LINE = last_line, $</code><br />
<code>LOG_IT = log_it, LOG_FOLDER = log_folder, $</code><br />
<code>SAVE_IT = save_it, SAVE_FOLDER = save_folder, $</code><br />
<code>MAP_IT = map_it, MAP_FOLDER = map_folder, $</code><br />
<code>VERBOSE = verbose, DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>misr_ptr {POINTER} [I]:</code> The pointer to a <code>STRING</code> array containing metadata on the <span class="smallcaps">MISR</span> <span class="smallcaps">Mode</span>, <span class="smallcaps">Path</span>, <span class="smallcaps">Orbit</span> and <span class="smallcaps">Block</span> to be processed.</p></li>
<li><p><code>radrd_ptr {POINTER array} [I]:</code> The array of 36 (9 cameras by 4 spectral bands) pointers to the data buffers containing the <code>UINT</code> <span class="smallcaps">L1B2</span> Georectified Radiance Product (GRP) scaled radiance values (with the <span class="smallcaps">RDQI</span> attached), in the native order (DF to DA and Blue to NIR).</p></li>
<li><p><code>rccm {BYTE array} [O]:</code> The cleaned RCCM product.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>RCCM_FOLDER = rccm_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the folder containing the <span class="smallcaps">MISR</span> <span class="smallcaps">RCCM</span> files, if they are not located in the default location.</p></li>
<li><p><code>RCCM_VERSION = rccm_version {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The <span class="smallcaps">MISR</span> <span class="smallcaps">RCCM</span> version identifier to use instead of the default value.</p></li>
<li><p><code>TEST_ID = test_id {STRING} [I] (Default value: &#8221;):</code> Flag to activate (<code>non-empty STRING</code>) or skip (<code>empty STRING</code>) artificially introducing missing data in the RCCM data buffer; if set, this keyword is used in output file names to label experiments.</p></li>
<li><p><code>FIRST_LINE = first_line {INT array of 9 elements} [I] (Default value: 9 elements set to -1):</code> The index (between 0 and 127) of the first line to be replaced by missing data, in each of the 9 cameras. Values outside that range are ignored.</p></li>
<li><p><code>LAST_LINE = last_line {INT array of 9 elements} [I] (Default value: 9 elements set to -1):</code> The index (between 0 and 127) of the last line to be replaced by missing data, in each of the 9 cameras. Values outside that range are ignored.</p></li>
<li><p><code>LOG_IT = log_it {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) generating a log file.</p></li>
<li><p><code>LOG_FOLDER = log_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the output folder containing the processing log.</p></li>
<li><p><code>SAVE_IT = save_it {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) saving the results in a savefile.</p></li>
<li><p><code>SAVE_FOLDER = save_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the output folder containing the savefile.</p></li>
<li><p><code>MAP_IT = map_it {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) generating maps of the numerical results.</p></li>
<li><p><code>MAP_FOLDER = map_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the output folder containing the maps.</p></li>
<li><p><code>VERBOSE = verbose {INT} [I] (Default value: 0):</code> Flag to enable (&gt; 0) or skip (0) outputting messages on the console:</p>
<ul>
<li><p>If <code>verbose &gt; 0</code>, messages inform the user about progress in the execution of time-consuming routines, or the location of output files (e.g., log, map, plot, etc.);</p></li>
<li><p>If <code>verbose &gt; 1</code>, messages record entering and exiting the routine; and</p></li>
<li><p>If <code>verbose &gt; 2</code>, messages provide additional information about intermediary results.</p></li>
</ul></li>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided in the call. The output positional parameter <code>rccm</code> contains a clean version of the <span class="smallcaps">MISR</span> <span class="smallcaps">RCCM</span> data product. The meaning of pixel values is as follows:</p>
<ul>
<li><p><code>0B</code>: Missing.</p></li>
<li><p><code>1B</code>: Cloud with high confidence.</p></li>
<li><p><code>2B</code>: Cloud with low confidence.</p></li>
<li><p><code>3B</code>: Clear with low confidence.</p></li>
<li><p><code>4B</code>: Clear with high confidence.</p></li>
<li><p><code>253B</code>: Obscured.</p></li>
<li><p><code>254B</code>: Edge.</p></li>
<li><p><code>255B</code>: Fill.</p></li>
</ul>
<p>If the optional input keyword parameter <code>TEST_ID</code> is set to a non-empty string, missing data are artificially introduced in the RCCM data between line <code>first_line</code> and <code>last_line</code> (inclusive), and a confusion matrix is assembled to document how the reconstructed values compare with the original data. The string <code>test_id</code> is used to label the results, as well as the output paths and file names.</p></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The output positional parameter <code>rccm</code> may be undefined, incomplete or incorrect.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Warning 98: The current computer is unrecognized.</p></li>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: The input positional parameter <code>misr_ptr</code> is not a pointer.</p></li>
<li><p>Error 120: The input positional parameter <code>radrd_ptr</code> is not a pointer array.</p></li>
<li><p>Error 130: The optional keyword parameter <code>test_id</code> is not of type <code>STRING</code>.</p></li>
<li><p>Error 140: The optional input keyword parameter <code>test_id</code> is set but the keyword parameter <code>first_line</code> is not set or invalid.</p></li>
<li><p>Error 150: The optional input keyword parameter <code>test_id</code> is set but the keyword parameter <code>last_line</code> is not set or invalid.</p></li>
<li><p>Error 199: An exception condition occurred in the function <code>set_roots_vers.pro</code>.</p></li>
<li><p>Error 200: Access to <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> Radiance data must be provided in Global Mode.</p></li>
<li><p>Error 210: An exception condition occurred in the function <code>path2str.pro</code>.</p></li>
<li><p>Error 220: An exception condition occurred in the function <code>orbit2str.pro</code>.</p></li>
<li><p>Error 230: An exception condition occurred in the function <code>orbit2date.pro</code>.</p></li>
<li><p>Error 299: The computer is not recognized and at least one of the optional input keyword parameters <code>rccm_folder</code>, <code>log_folder</code>, <code>save_folder</code>, <code>map_folder</code> is not specified.</p></li>
<li><p>Error 300: An exception condition occurred in the function <code>find_rccm_files.pro</code>.</p></li>
<li><p>Error 400: The output folder <code>log_path</code> is unwritable.</p></li>
<li><p>Error 410: The output folder <code>save_path</code> is unwritable.</p></li>
<li><p>Error 500: An exception condition occurred in the function <code>mk_rccm_0.pro</code>.</p></li>
<li><p>Error 510: An exception condition occurred in the function <code>map_rccm_block.pro</code> while attempting to map the original <code>rccm_0</code> data.</p></li>
<li><p>Error 512: An exception condition occurred in the function <code>map_rccm_block.pro</code> while attempting to map the artificially modified <code>rccm_0</code> data.</p></li>
<li><p>Error 520: An exception condition occurred in the function <code>mk_rccm_1.pro</code>.</p></li>
<li><p>Error 530: An exception condition occurred in the function <code>map_rccm_block.pro</code> while attempting to map <code>rccm_1</code>.</p></li>
<li><p>Error 540: An exception condition occurred in the function <code>mk_rccm_2.pro</code>.</p></li>
<li><p>Error 550: An exception condition occurred in the function <code>map_rccm_block.pro</code> while attempting to map <code>rccm_2</code>.</p></li>
<li><p>Error 560: An exception condition occurred in the function <code>mk_rccm_3.pro</code>.</p></li>
<li><p>Error 570: An exception condition occurred in the function <code>map_rccm_block.pro</code> while attempting to map <code>rccm_3</code>.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>force_path_sep.pro</code></p></li>
<li><p><code>get_host_info.pro</code></p></li>
<li><p><code>is_array.pro</code></p></li>
<li><p><code>is_numeric.pro</code></p></li>
<li><p><code>is_pointer.pro</code></p></li>
<li><p><code>is_writable_dir.pro</code></p></li>
<li><p><code>make_bytemap.pro</code></p></li>
<li><p><code>map_rccm_block.pro</code></p></li>
<li><p><code>mk_rccm0.pro</code></p></li>
<li><p><code>mk_rccm1.pro</code></p></li>
<li><p><code>mk_rccm2.pro</code></p></li>
<li><p><code>mk_rccm3.pro</code></p></li>
<li><p><code>orbit2date.pro</code></p></li>
<li><p><code>orbit2str.pro</code></p></li>
<li><p><code>path2str.pro</code></p></li>
<li><p><code>set_misr_specs.pro</code></p></li>
<li><p><code>set_roots_vers.pro</code></p></li>
<li><p><code>str2block.pro</code></p></li>
<li><p><code>str2orbit.pro</code></p></li>
<li><p><code>str2path.pro</code></p></li>
<li><p><code>strcat.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
<li><p><code>today.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> If maps are requested by setting the input keyword parameter <code>map_it</code>, map legends are also saved as text files with matching names to describe the contents of these maps.</p></li>
<li><p><strong>Note 2:</strong> The <span class="smallcaps">MISR</span> <span class="smallcaps">RCCM</span> product is only available at the reduced spatial resolution of 128 line by 512 samples per <span class="smallcaps">Block</span>, for all 9 cameras.</p></li>
<li><p><strong>Note 3:</strong> The <span class="smallcaps">MISR</span> <span class="smallcaps">RCCM</span> product is provided on a per-camera basis, and the cloud mask for a given camera applies to all 4 spectral bands of that camera.</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>IDL&gt; misr_mode = &#39;GM&#39;
IDL&gt; misr_path = 168
IDL&gt; misr_orbit = 68050
IDL&gt; verbose = 0
IDL&gt; debug = 1
IDL&gt; rc = find_l1b2gm_files(misr_path, misr_orbit, l1b2gm_files, $
   L1B2GM_FOLDER = l1b2gm_folder, L1B2GM_VERSION = l1b2gm_version, $
   DEBUG = debug, EXCPT_COND = excpt_cond)
IDL&gt; misr_block = 110
IDL&gt; rc = heap_l1b2_block(l1b2gm_files, misr_block, $
   misr_ptr, radrd_ptr, brf_ptr, rdqi_ptr, $
   DEBUG = debug, EXCPT_COND = excpt_cond)
IDL&gt; log_it = 1
IDL&gt; save_it = 1
IDL&gt; map_it = 1
IDL&gt; rc = fix_rccm(misr_ptr, radrd_ptr, rccm, $
   RCCM_FOLDER = rccm_folder, RCCM_VERSION = rccm_version, $
   LOG_IT = log_it, LOG_FOLDER = log_folder, $
   SAVE_IT = save_it, SAVE_FOLDER = save_folder, $
   MAP_IT = map_it, MAP_FOLDER = map_folder, $
   VERBOSE = verbose, DEBUG = debug, EXCPT_COND = excpt_cond)
IDL&gt; PRINT, &#39;rc = &#39;, rc
rc =            0</code></pre></li>
<li><p><strong>References:</strong></p>
<ul>
<li><p>Mike Bull, Jason Matthews, Duncan McDonald, Alexander Menzies, Catherine Moroney, Kevin Mueller, Susan Paradise, Mike Smyth (2011) <em>MISR Data Products Specifications</em>, <strong>JPL D-13963</strong>, <strong>Revision S</strong>, Jet Propulsion Laboratory, California Institute of Technology, Pasadena, CA, USA.</p></li>
<li><p>Diner, D. J., Di Girolamo, L. and Clothiaux, E. E. (1999) <em>Level 1 Cloud Detection Algorithm Theoretical Basis</em>, Technical Report <strong>JPL D-13397, Revision B</strong>, Jet Propulsion Laboratory, California Institute of Technology, Pasadena, CA, USA.</p></li>
<li><p>Michel Verstraete, Linda Hunt, Hugo De Lemos and Larry Di Girolamo (2019) <em>Replacing Missing Values in the Standard MISR Radiometric Camera-by-Camera Cloud Mask (RCCM) Data Product</em>, <code>Earth System Science Data Discussions</code>, Vol. 2019, p. 1&#8211;18, available from <a href="https://www.earth-syst-sci-data-discuss.net/essd-2019-77/" class="uri">https://www.earth-syst-sci-data-discuss.net/essd-2019-77/</a> (DOI: 10.5194/essd-2019-77).</p></li>
</ul></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2018&#8211;08&#8211;08: Version 0.8 &#8212; Original routines to manipulate <span class="smallcaps">MISR</span> <span class="smallcaps">RCCM</span> data products provided by Linda Hunt.</p></li>
<li><p>2018&#8211;12&#8211;23: Version 0.9 &#8212; Initial release: This function and those it depends on supersede all previous routines dealing with <span class="smallcaps">MISR</span> <span class="smallcaps">RCCM</span> data products.</p></li>
<li><p>2018&#8211;12&#8211;30: Version 1.0 &#8212; Initial public release.</p></li>
<li><p>2019&#8211;01&#8211;30: Version 1.1 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;02&#8211;02: Version 1.2 &#8212; Add further diagnostic information in the log file, update the code and the documentation.</p></li>
<li><p>2019&#8211;02&#8211;05: Version 1.3 &#8212; Reorganize the <span class="smallcaps">MISR</span> <span class="smallcaps">RCCM</span> functions.</p></li>
<li><p>2019&#8211;02&#8211;07: Version 1.4 &#8212; Rename this function from <code>get_rccm.pro</code> to<br />
<code>fix_rccm.pro</code>.</p></li>
<li><p>2019&#8211;02&#8211;18: Version 2.00 &#8212;&#8211; Implement new algorithm (multiple scans of the input cloud mask) to minimize artifacts in the filled areas.</p></li>
<li><p>2019&#8211;02&#8211;24: Version 2.01 &#8211;&#8212; Documentation update.</p></li>
<li><p>2019&#8211;02&#8211;27: Version 2.02 &#8212; Implement an improved algorithm, capable of effectively dealing with cases where most values are missing within a <span class="smallcaps">Block</span>, as long as values are not missing in neighboring cameras, take advantage of the new functions <code>find_rccm_files.pro</code> and <code>map_rccm_block.pro</code>, and update the documentation.</p></li>
<li><p>2019&#8211;03&#8211;28: Version 2.10 &#8212; Update the handling of the optional input keyword parameter <code>VERBOSE</code> and generate the software version consistent with the published documentation.</p></li>
<li><p>2019&#8211;04&#8211;08: Version 2.11 &#8212; Bug fix: Add <code>IF</code> statement on line 943.</p></li>
<li><p>2019&#8211;05&#8211;07: Version 2.15 &#8212; Software version described in the preprint published in ESSD Discussions mentioned above.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the use of <code>verbose</code> and the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
<li><p>2019&#8211;09&#8211;10: Version 2.1.1 &#8212; Add arguments and code to artificially insert missing data in the RCCM data buffer, and build a confusion matrix to document the performance of the replacement algorithm.</p></li>
<li><p>2019&#8211;09&#8211;24: Version 2.1.2 &#8212; Update the code (1) to map the original <span class="smallcaps">RCCM</span> data before artificially inserting additional missing data, (2) to record the confusion matrices after <code>mk_rccm2</code> and <code>mk_rccm3</code> in the log file, and (3) to modify the default map output directory.</p></li>
</ul></li>
</ul>
<h2>map_rccm_block</h2>
<ul>
<li><p><strong>Purpose:</strong> This function saves maps of the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> Georectified Radiance Product (GRP) Radiometric Camera-by-camera Cloud Mask (RCCM) data product, together with the corresponding legends, in the default or specified folder.</p></li>
<li><p><strong>Algorithm:</strong> This function generates</p>
<ul>
<li><p>a map of the <span class="smallcaps">MISR</span> <span class="smallcaps">RCCM</span> data product for each of the 9 cameras of the specified <span class="smallcaps">Path</span>, <span class="smallcaps">Orbit</span> and <span class="smallcaps">Block</span> into <code>.png</code> files, and</p></li>
<li><p>a legend for each of those maps into <code>.txt</code> files,</p></li>
</ul>
<p>using a pre-defined color scheme. These files are saved in the default or specified folder. If multiple versions of this <span class="smallcaps">RCCM</span> data product must be mapped, the input positional parameter <code>rccm_logo</code> is used to differentiate the filenames, and the input positional parameter <code>rccm_lgnd</code> is inserted into the standard legend to describe the specificity of this particular set of maps.</p></li>
<li><p><strong>Syntax:</strong> <code>rc = map_rccm_block(misr_path, misr_orbit, misr_block, $</code><br />
<code>rccm, rccm_logo, rccm_lgnd, TEST_ID = test_id, $</code><br />
<code>MAP_IT = map_it, MAP_FOLDER = map_folder, $</code><br />
<code>VERBOSE = verbose, DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>misr_path {INTEGER} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span> number.</p></li>
<li><p><code>misr_orbit {LONG} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Orbit</span> number.</p></li>
<li><p><code>misr_block {INTEGER} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Block</span> number.</p></li>
<li><p><code>rccm {BYTE array} [I]:</code> The <span class="smallcaps">RCCM</span> data product, an array dimensioned <code>[9, 512, 128]</code>.</p></li>
<li><p><code>rccm_logo {STRING} [I]:</code> The identifier to be used in the map and legend filenames to differentiate product versions.</p></li>
<li><p><code>rccm_lgnd {STRING} [I]:</code> The text fragment to be inserted in the map legend to differentiate product versions.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>TEST_ID = test_id {STRING} [I] (Default value: &#8221;):</code> Flag to activate (<code>non-empty STRING</code>) or skip (<code>empty STRING</code>) artificially introducing missing data in the RCCM data buffer; if set, this keyword is used in output file names to label experiments.</p></li>
<li><p><code>MAP_IT = map_it {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) generating maps of the numerical results.</p></li>
<li><p><code>MAP_FOLDER = map_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the output folder containing the maps.</p></li>
<li><p><code>VERBOSE = verbose {INT} [I] (Default value: 0):</code> Flag to enable (&gt; 0) or skip (0) outputting messages on the console:</p>
<ul>
<li><p>If <code>verbose &gt; 0</code>, messages inform the user about progress in the execution of time-consuming routines, or the location of output files (e.g., log, map, plot, etc.);</p></li>
<li><p>If <code>verbose &gt; 1</code>, messages record entering and exiting the routine; and</p></li>
<li><p>If <code>verbose &gt; 2</code>, messages provide additional information about intermediary results.</p></li>
</ul></li>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided in the call. The maps and legends are saved in the default or specified folder.</p></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The maps and legends may be inexistent, incomplete or incorrect.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: The input positional parameter <code>misr_path</code> is invalid.</p></li>
<li><p>Error 120: The input positional parameter <code>misr_orbit</code> is invalid.</p></li>
<li><p>Error 122: The input positional parameter <code>misr_orbit</code> is inconsistent with the input positional parameter <code>misr_path</code>.</p></li>
<li><p>Error 124: An exception condition occurred in <code>is_frompath.pro</code>.</p></li>
<li><p>Error 130: The input positional parameter <code>misr_block</code> is invalid.</p></li>
<li><p>Error 140: The input positional parameter <code>rccm</code> is invalid.</p></li>
<li><p>Error 150: The input positional parameter <code>rccm_logo</code> is invalid.</p></li>
<li><p>Error 160: The input positional parameter <code>rccm_lgnd</code> is invalid.</p></li>
<li><p>Error 199: An exception condition occurred in <code>set_roots_vers.pro</code>.</p></li>
<li><p>Error 200: An exception condition occurred in function <code>path2str.pro</code>.</p></li>
<li><p>Error 210: An exception condition occurred in function <code>orbit2str.pro</code>.</p></li>
<li><p>Error 220: An exception condition occurred in function <code>block2str.pro</code>.</p></li>
<li><p>Error 230: An exception condition occurred in function <code>orbit2date.pro</code>.</p></li>
<li><p>Error 299: The computer is not recognized and the optional input keyword parameter <code>map_folder</code> is not specified.</p></li>
<li><p>Error 400: The output folder <code>map_fpath</code> is unwritable.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>block2str.pro</code></p></li>
<li><p><code>chk_misr_block.pro</code></p></li>
<li><p><code>chk_misr_orbit.pro</code></p></li>
<li><p><code>chk_misr_path.pro</code></p></li>
<li><p><code>force_path_sep.pro</code></p></li>
<li><p><code>is_frompath.pro</code></p></li>
<li><p><code>is_numeric.pro</code></p></li>
<li><p><code>is_scalar.pro</code></p></li>
<li><p><code>is_string.pro</code></p></li>
<li><p><code>is_writable.pro</code></p></li>
<li><p><code>lr2hr.pro</code></p></li>
<li><p><code>make_bytemap.pro</code></p></li>
<li><p><code>orbit2date.pro</code></p></li>
<li><p><code>orbit2str.pro</code></p></li>
<li><p><code>path2str.pro</code></p></li>
<li><p><code>set_misr_specs.pro</code></p></li>
<li><p><code>set_roots_vers.pro</code></p></li>
<li><p><code>strcat.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
<li><p><code>today.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> Since the purpose of this function is to map the input positional parameter <code>rccm</code>, these maps are generated irrespective of the setting of the input keyword parameter <code>MAP_IT</code>.</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>IDL&gt; misr_path = 168
IDL&gt; misr_orbit = 68050
IDL&gt; misr_block = 110
IDL&gt; rccm_logo = &#39;rccm0&#39;
IDL&gt; rccm_lgnd = &#39;&#39;
IDL&gt; rc = map_rccm_block(misr_path, misr_orbit, $
   misr_block, rccm_0, rccm_logo, rccm_lgnd, $
   MAP_IT = map_it, MAP_FOLDER = map_folder, $
   DEBUG = debug, EXCPT_COND = excpt_cond)
IDL&gt; PRINT, rc
       0</code></pre></li>
<li><p><strong>References:</strong></p>
<ul>
<li><p>Michel Verstraete, Linda Hunt, Hugo De Lemos and Larry Di Girolamo (2019) <em>Replacing Missing Values in the Standard MISR Radiometric Camera-by-Camera Cloud Mask (RCCM) Data Product</em>, <code>Earth System Science Data Discussions</code>, Vol. 2019, p. 1&#8211;18, available from <a href="https://www.earth-syst-sci-data-discuss.net/essd-2019-77/" class="uri">https://www.earth-syst-sci-data-discuss.net/essd-2019-77/</a> (DOI: 10.5194/essd-2019-77).</p></li>
</ul></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2019&#8211;02&#8211;27: Version 0.9 &#8212; Initial release.</p></li>
<li><p>2019&#8211;03&#8211;01: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;03&#8211;28: Version 2.10 &#8212; Update the handling of the optional input keyword parameter <code>VERBOSE</code> and generate the software version consistent with the published documentation.</p></li>
<li><p>2019&#8211;05&#8211;07: Version 2.15 &#8212; Software version described in the preprint published in ESSD Discussions mentioned above.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the use of <code>verbose</code> and the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
<li><p>2019&#8211;09&#8211;10: Version 2.1.1 &#8212; Add the <code>TEST_ID</code> keyword to save the output maps in dedicated folders and files.</p></li>
<li><p>2019&#8211;09&#8211;25: Version 2.1.2 &#8212; Update the code to modify the default map output directory.</p></li>
<li><p>2019&#8211;12&#8211;09: Version 2.1.3 &#8212; Update the code to output the path address of the folder containing the maps if the input keyword parameter <code>verbose</code> is set.</p></li>
</ul></li>
</ul>
<h2>mk_rccm0</h2>
<ul>
<li><p><strong>Purpose:</strong> This function retrieves the standard <span class="smallcaps">Radiometric</span> <span class="smallcaps">Camera</span> <span class="smallcaps">to</span> <span class="smallcaps">camera</span> <span class="smallcaps">Cloud</span> <span class="smallcaps">Masks</span> (<span class="smallcaps">RCCM</span>) from the original <span class="smallcaps">MISR</span> data product files.</p></li>
<li><p><strong>Algorithm:</strong> This function reads the 9 <span class="smallcaps">MISR</span> <span class="smallcaps">RCCM</span> data product files and extracts the cloud masks.</p></li>
<li><p><strong>Syntax:</strong> <code>rc = mk_rccm0(rccm_files, misr_path, misr_orbit, $</code><br />
<code>misr_block, rccm_0, n_miss_0, $</code><br />
<code>VERBOSE = verbose, DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>rccm_files {STRING array} [I]:</code> An array containing the file specifications for the 9 <span class="smallcaps">RCCM</span> files corresponding to the selected <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span> and <span class="smallcaps">Orbit</span>.</p></li>
<li><p><code>misr_path {INTEGER} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span> number.</p></li>
<li><p><code>misr_orbit {LONG} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Orbit</span> number.</p></li>
<li><p><code>misr_block {INTEGER} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Block</span> number.</p></li>
<li><p><code>rccm_0 {BYTE array} [O]:</code> An array containing the standard <span class="smallcaps">RCCM</span> product for the 9 camera files corresponding to the selected <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span>, <span class="smallcaps">Orbit</span> and <span class="smallcaps">Block</span>.</p></li>
<li><p><code>n_miss_0 {LONG array} [O]:</code> An array reporting how many non-retrieved values (<code>0B</code>) exist in each of these 9 cloud masks.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>VERBOSE = verbose {INT} [I] (Default value: 0):</code> Flag to enable (&gt; 0) or skip (0) outputting messages on the console:</p>
<ul>
<li><p>If <code>verbose &gt; 0</code>, messages inform the user about progress in the execution of time-consuming routines, or the location of output files (e.g., log, map, plot, etc.);</p></li>
<li><p>If <code>verbose &gt; 1</code>, messages record entering and exiting the routine; and</p></li>
<li><p>If <code>verbose &gt; 2</code>, messages provide additional information about intermediary results.</p></li>
</ul></li>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided in the call. The output positional parameters <code>rccm_0</code> and <code>n_miss_0</code> contain the cloud masks and the number of non-retrieved values in each of them, respectively. The meaning of pixel values is as follows:</p>
<ul>
<li><p><code>0B</code>: No retrieval.</p></li>
<li><p><code>1B</code>: Cloud with high confidence.</p></li>
<li><p><code>2B</code>: Cloud with low confidence.</p></li>
<li><p><code>3B</code>: Clear with low confidence.</p></li>
<li><p><code>4B</code>: Clear with high confidence.</p></li>
<li><p><code>255B</code>: Fill.</p></li>
</ul></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The output positional parameters <code>rccm_0</code> and <code>n_miss_0</code> may be inexistent, incomplete or incorrect.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: The input positional parameter <code>rccm_files</code> is not of type <code>STRING</code>.</p></li>
<li><p>Error 120: The input positional parameter <code>rccm_files</code> is not an array.</p></li>
<li><p>Error 130: Input positional parameter <code>misr_block</code> is invalid.</p></li>
<li><p>Error 200: An exception condition occurred in the function <code>fn2mpocbv.pro</code>.</p></li>
<li><p>Error 210: An exception condition occurred in the function <code>str2path.pro</code>.</p></li>
<li><p>Error 220: An exception condition occurred in the function <code>str2orbit.pro</code>.</p></li>
<li><p>Error 230: An exception condition occurred in the function <code>block2str.pro</code>.</p></li>
<li><p>Error 300: One of the input <span class="smallcaps">MISR</span> <span class="smallcaps">RCCM</span> files exists but is unreadable.</p></li>
<li><p>Error 600: An exception condition occurred in the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> routine<br />
<code>MTK_SETREGION_BY_PATH_BLOCKRANGE</code>.</p></li>
<li><p>Error 610: An exception condition occurred in the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> routine<br />
<code>MTK_READDATA</code>.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>MISR Toolkit</code></p></li>
<li><p><code>block2str.pro</code></p></li>
<li><p><code>chk_misr_block.pro</code></p></li>
<li><p><code>chk_misr_orbit.pro</code></p></li>
<li><p><code>chk_misr_path.pro</code></p></li>
<li><p><code>fn2mpocbv.pro</code></p></li>
<li><p><code>is_numeric.pro</code></p></li>
<li><p><code>is_readable_file.pro</code></p></li>
<li><p><code>set_misr_specs.pro</code></p></li>
<li><p><code>str2orbit.pro</code></p></li>
<li><p><code>str2path.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong> None.</p></li>
<li><p><strong>Examples:</strong></p>
<pre><code>[See the outcome(s) generated by fix_rccm.pro]</code></pre></li>
<li><p><strong>References:</strong></p>
<ul>
<li><p>Mike Bull, Jason Matthews, Duncan McDonald, Alexander Menzies, Catherine Moroney, Kevin Mueller, Susan Paradise, Mike Smyth (2011) <em>MISR Data Products Specifications</em>, <strong>JPL D-13963</strong>, <strong>Revision S</strong>, Section 6.7.6, p. 85, Jet Propulsion Laboratory, California Institute of Technology, Pasadena, CA, USA.</p></li>
<li><p>Michel Verstraete, Linda Hunt, Hugo De Lemos and Larry Di Girolamo (2019) <em>Replacing Missing Values in the Standard MISR Radiometric Camera-by-Camera Cloud Mask (RCCM) Data Product</em>, <code>Earth System Science Data Discussions</code>, Vol. 2019, p. 1&#8211;18, available from <a href="https://www.earth-syst-sci-data-discuss.net/essd-2019-77/" class="uri">https://www.earth-syst-sci-data-discuss.net/essd-2019-77/</a> (DOI: 10.5194/essd-2019-77).</p></li>
</ul></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2018&#8211;08&#8211;08: Version 0.8 &#8212; Original routines to manipulate <span class="smallcaps">MISR</span> <span class="smallcaps">RCCM</span> data products provided by Linda Hunt.</p></li>
<li><p>2018&#8211;12&#8211;23: Version 0.9 &#8212; Initial release: This function and those it depends on supersede all previous routines dealing with <span class="smallcaps">MISR</span> <span class="smallcaps">RCCM</span> data products.</p></li>
<li><p>2018&#8211;12&#8211;30: Version 1.0 &#8212; Initial public release.</p></li>
<li><p>2019&#8211;01&#8211;30: Version 1.1 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;02&#8211;02: Version 1.2 &#8212; Delete unused variable <code>pob_str</code>.</p></li>
<li><p>2019&#8211;02&#8211;05: Version 1.3 &#8212; Reorganize the <span class="smallcaps">MISR</span> <span class="smallcaps">RCCM</span> functions.</p></li>
<li><p>2019&#8211;02&#8211;18: Version 2.00 &#8212; Implement new algorithm (multiple scans of the input cloud mask) to minimize artifacts in the filled areas.</p></li>
<li><p>2019&#8211;02&#8211;27: Version 2.01 &#8212; New improved algorithm, capable of dealing with cases where most values are missing within a <span class="smallcaps">Block</span>, as long as values are not missing in neighboring cameras, rename this function from <code>mk_rccm_0</code> to <code>mk_rccm0</code>, and update the documentation.</p></li>
<li><p>2019&#8211;03&#8211;28: Version 2.10 &#8212; Update the handling of the optional input keyword parameter <code>VERBOSE</code> and generate the software version consistent with the published documentation.</p></li>
<li><p>2019&#8211;05&#8211;04: Version 2.11 &#8212; Update the code to report the specific error message of MTK routines.</p></li>
<li><p>2019&#8211;05&#8211;07: Version 2.15 &#8212; Software version described in the preprint published in ESSD Discussions mentioned above.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the use of <code>verbose</code> and the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
<li><p>2019&#8211;12&#8211;09: Version 2.1.1 &#8212; Update the code to use the current version of function <code>fn2mpocbv.pro</code>.</p></li>
</ul></li>
</ul>
<h2>mk_rccm1</h2>
<ul>
<li><p><strong>Purpose:</strong> This function flags pixels obscured by topography or located on the edges of the <span class="smallcaps">MISR</span> instrument swath within the standard <span class="smallcaps">RCCM</span>, provided through the input positional parameter <code>rccm_0</code>.</p></li>
<li><p><strong>Algorithm:</strong> This function uses the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> scaled radiance data (with the <span class="smallcaps">RDQI</span> attached) for the selected <span class="smallcaps">Mode</span>, <span class="smallcaps">Path</span>, <span class="smallcaps">Orbit</span> and <span class="smallcaps">Block</span>, accessed on the heap through the array of pointers <code>radrd_ptr</code>, to flag obscured and ege pixels within the standard <span class="smallcaps">RCCM</span>, available as input array <code>rccm_0</code>.</p></li>
<li><p><strong>Syntax:</strong> <code>rc = mk_rccm1(rccm_0, misr_ptr, radrd_ptr, $</code><br />
<code>rccm_1, n_miss_1, VERBOSE = verbose, $</code><br />
<code>DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>rccm_0 {BYTE array} [I]:</code> An array containing the standard <span class="smallcaps">RCCM</span> product for the 9 camera files corresponding to the selected <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span>, <span class="smallcaps">Orbit</span> and <span class="smallcaps">Block</span>.</p></li>
<li><p><code>misr_ptr {POINTER} [I]:</code> The pointer to a <code>STRING</code> array containing metadata on the <span class="smallcaps">MISR</span> <span class="smallcaps">Mode</span>, <span class="smallcaps">Path</span>, <span class="smallcaps">Orbit</span> and <span class="smallcaps">Block</span> of the next pointer array.</p></li>
<li><p><code>radrd_ptr {POINTER array} [I]:</code> The array of 36 pointers to the data buffers containing the <code>UINT</code> <span class="smallcaps">L1B2</span> scaled radiance values (with the <span class="smallcaps">RDQI</span> attached), in the native order (DF to DA).</p></li>
<li><p><code>rccm_1 {BYTE array} [O]:</code> An array containing the updated <span class="smallcaps">RCCM</span> product for the 9 camera files corresponding to the selected <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span>, <span class="smallcaps">Orbit</span> and <span class="smallcaps">Block</span>, i.e., with non zero values for edge and obscured pixels.</p></li>
<li><p><code>n_miss_1 {LONG array} [O]:</code> An array reporting how many missing values (<code>0B</code>) remain in each of these 9 cloud masks.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>VERBOSE = verbose {INT} [I] (Default value: 0):</code> Flag to enable (&gt; 0) or skip (0) outputting messages on the console:</p>
<ul>
<li><p>If <code>verbose &gt; 0</code>, messages inform the user about progress in the execution of time-consuming routines, or the location of output files (e.g., log, map, plot, etc.);</p></li>
<li><p>If <code>verbose &gt; 1</code>, messages record entering and exiting the routine; and</p></li>
<li><p>If <code>verbose &gt; 2</code>, messages provide additional information about intermediary results.</p></li>
</ul></li>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided in the call. The output positional parameters <code>rccm_1</code> and <code>n_miss_1</code> contain the updated cloud masks and the number of missing values in each of them, respectively. The meaning of pixel values in <code>rccm_1</code> is as follows:</p>
<ul>
<li><p><code>0B</code>: Missing.</p></li>
<li><p><code>1B</code>: Cloud with high confidence.</p></li>
<li><p><code>2B</code>: Cloud with low confidence.</p></li>
<li><p><code>3B</code>: Clear with low confidence.</p></li>
<li><p><code>4B</code>: Clear with high confidence.</p></li>
<li><p><code>253B</code>: Obscured.</p></li>
<li><p><code>254B</code>: Edge.</p></li>
<li><p><code>255B</code>: Fill.</p></li>
</ul></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The output positional parameters <code>rccm_1</code> and <code>n_miss_1</code> may be inexistent, incomplete or incorrect.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: The input positional parameter <code>rccm_0</code> is invalid.</p></li>
<li><p>Error 120: The input positional parameter <code>misr_ptr</code> is not a pointer array.</p></li>
<li><p>Error 130: The input positional parameter <code>radrd_ptr</code> is not a pointer array.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>is_array.pro</code></p></li>
<li><p><code>is_numeric.pro</code></p></li>
<li><p><code>is_pointer.pro</code></p></li>
<li><p><code>set_misr_specs.pro</code></p></li>
<li><p><code>strcat.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong> None.</p></li>
<li><p><strong>Examples:</strong></p>
<pre><code>[See the outcome(s) generated by fix_rccm.pro]</code></pre></li>
<li><p><strong>References:</strong></p>
<ul>
<li><p>Mike Bull, Jason Matthews, Duncan McDonald, Alexander Menzies, Catherine Moroney, Kevin Mueller, Susan Paradise, Mike Smyth (2011) <em>MISR Data Products Specifications</em>, <strong>JPL D-13963</strong>, <strong>Revision S</strong>, Section 6.7.6, p. 85, Jet Propulsion Laboratory, California Institute of Technology, Pasadena, CA, USA.</p></li>
<li><p>Michel Verstraete, Linda Hunt, Hugo De Lemos and Larry Di Girolamo (2019) <em>Replacing Missing Values in the Standard MISR Radiometric Camera-by-Camera Cloud Mask (RCCM) Data Product</em>, <code>Earth System Science Data Discussions</code>, Vol. 2019, p. 1&#8211;18, available from <a href="https://www.earth-syst-sci-data-discuss.net/essd-2019-77/" class="uri">https://www.earth-syst-sci-data-discuss.net/essd-2019-77/</a> (DOI: 10.5194/essd-2019-77).</p></li>
</ul></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2018&#8211;08&#8211;08: Version 0.8 &#8212; Original routines to manipulate <span class="smallcaps">MISR</span> <span class="smallcaps">RCCM</span> data products provided by Linda Hunt.</p></li>
<li><p>2018&#8211;12&#8211;23: Version 0.9 &#8212; Initial release: This function and those it depends on supersede all previous routines dealing with <span class="smallcaps">MISR</span> <span class="smallcaps">RCCM</span> data products.</p></li>
<li><p>2018&#8211;12&#8211;30: Version 1.0 &#8212; Initial public release.</p></li>
<li><p>2019&#8211;01&#8211;30: Version 1.1 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;02&#8211;02: Version 1.2 &#8212; Delete unused variable <code>pob_str</code> and use the Radiance rather than the Radiance/RDQI field in <span class="smallcaps">L1B2</span> files.</p></li>
<li><p>2019&#8211;02&#8211;05: Version 1.3 &#8212; Reorganize the <span class="smallcaps">MISR</span> <span class="smallcaps">RCCM</span> functions.</p></li>
<li><p>2019&#8211;02&#8211;18: Version 2.00 &#8212; Implement new algorithm (multiple scans of the input cloud mask) to minimize artifacts in the filled areas.</p></li>
<li><p>2019&#8211;02&#8211;27: Version 2.01 &#8212; New improved algorithm, capable of dealing with cases where most values are missing within a <span class="smallcaps">Block</span>, as long as values are not missing in neighboring cameras, access <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> data through pointers to heap variables rather than by reading data files, rename this function from <code>mk_rccm_1</code> to <code>mk_rccm1</code>, and update the documentation.</p></li>
<li><p>2019&#8211;03&#8211;28: Version 2.10 &#8212; Update the handling of the optional input keyword parameter <code>VERBOSE</code> and generate the software version consistent with the published documentation.</p></li>
<li><p>2019&#8211;05&#8211;07: Version 2.15 &#8212; Software version described in the preprint published in ESSD Discussions mentioned above.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the use of <code>verbose</code> and the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
<li><p>2019&#8211;09&#8211;28: Version 2.1.1 &#8212; Update the code to use the current version of the function <code>hr2lr.pro</code>.</p></li>
</ul></li>
</ul>
<h2>mk_rccm2</h2>
<ul>
<li><p><strong>Purpose:</strong> This function replaces missing values in the cloud mask <code>rccm_1</code> for one camera by the values found in its 2 immediate neighbors whenever the latter are identical.</p></li>
<li><p><strong>Algorithm:</strong> For each camera-specific cloud mask containing missing values, this function inspects the 2 immediate neighboring cameras, replaces the missing values if both of them report the same cloud mask value, and updates the output cloud mask <code>rccm_2</code>.</p></li>
<li><p><strong>Syntax:</strong> <code>rc = mk_rccm2(rccm_1, n_miss_1, rccm_2, n_miss_2, $</code><br />
<code>VERBOSE = verbose, DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>VERBOSE = verbose {INT} [I] (Default value: 0):</code> Flag to enable (&gt; 0) or skip (0) outputting messages on the console:</p>
<ul>
<li><p>If <code>verbose &gt; 0</code>, messages inform the user about progress in the execution of time-consuming routines, or the location of output files (e.g., log, map, plot, etc.);</p></li>
<li><p>If <code>verbose &gt; 1</code>, messages record entering and exiting the routine; and</p></li>
<li><p>If <code>verbose &gt; 2</code>, messages provide additional information about intermediary results.</p></li>
</ul></li>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided in the call. The output positional parameters <code>rccm_2</code> and <code>n_miss_2</code> contain the upgraded cloud masks and the number of missing values in each of them, respectively. The meaning of pixel values in <code>rccm_2</code> is as follows:</p>
<ul>
<li><p><code>0B</code>: Missing.</p></li>
<li><p><code>1B</code>: Cloud with high confidence.</p></li>
<li><p><code>2B</code>: Cloud with low confidence.</p></li>
<li><p><code>3B</code>: Clear with low confidence.</p></li>
<li><p><code>4B</code>: Clear with high confidence.</p></li>
<li><p><code>253B</code>: Obscured.</p></li>
<li><p><code>254B</code>: Edge.</p></li>
<li><p><code>255B</code>: Fill.</p></li>
</ul></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The output positional parameters <code>rccm_2</code> and <code>n_miss_2</code> may be inexistent, incomplete or incorrect.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>is_numeric.pro</code></p></li>
<li><p><code>set_misr_specs.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> This function only replaces missing values when both neighboring cameras report identical valid values. This assumes that the cloud fields are homogeneous over the range of observation angles encompassing the 3 cameras. Errors may occur with highly discontinuous cloud fields at high altitude. Ambiguous cases (i.e., where neighboring cameras report different values) are treated by function <code>mk_rccm3</code>.</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>[See the outcome(s) generated by fix_rccm.pro]</code></pre></li>
<li><p><strong>References:</strong></p>
<ul>
<li><p>Michel Verstraete, Linda Hunt, Hugo De Lemos and Larry Di Girolamo (2019) <em>Replacing Missing Values in the Standard MISR Radiometric Camera-by-Camera Cloud Mask (RCCM) Data Product</em>, <code>Earth System Science Data Discussions</code>, Vol. 2019, p. 1&#8211;18, available from <a href="https://www.earth-syst-sci-data-discuss.net/essd-2019-77/" class="uri">https://www.earth-syst-sci-data-discuss.net/essd-2019-77/</a> (DOI: 10.5194/essd-2019-77).</p></li>
</ul></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2019&#8211;02&#8211;25: Version 1.0 &#8212; Initial release.</p></li>
<li><p>2019&#8211;02&#8211;27: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;02&#8211;27: Version 2.01 &#8212; New improved algorithm, capable of dealing with cases where most values are missing within a <span class="smallcaps">Block</span>, as long as values are not missing in neighboring cameras, and update the documentation.</p></li>
<li><p>2019&#8211;03&#8211;28: Version 2.10 &#8212; Update the handling of the optional input keyword parameter <code>VERBOSE</code> and generate the software version consistent with the published documentation.</p></li>
<li><p>2019&#8211;05&#8211;07: Version 2.15 &#8212; Software version described in the preprint published in ESSD Discussions mentioned above.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the use of <code>verbose</code> and the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
</ul></li>
</ul>
<h2>mk_rccm3</h2>
<ul>
<li><p><strong>Purpose:</strong> This function attempts to replace missing values in the <code>rccm_2</code> cloud mask by reasonable estimates determined on the basis of the values of its immediate neighbors.</p></li>
<li><p><strong>Algorithm:</strong> This function uses square sub-windows of various sizes, within the input array <code>rccm_2</code> and centered on each successive missing pixel, to compute basic non-parametric statistics on the frequencies of neighboring values and propose a reasonable replacement value.</p></li>
<li><p><strong>Syntax:</strong> <code>rc = mk_rccm3(rccm_2, rccm_3, n_miss_3, $</code><br />
<code>VERBOSE = verbose, DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>rccm_2 {BYTE array} [I]:</code> An array containing the upgraded <span class="smallcaps">RCCM</span> product for the 9 camera files corresponding to the selected <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span>, <span class="smallcaps">Orbit</span> and <span class="smallcaps">Block</span>, i.e., with non zero values for edge and obscured pixels, and with some of the missing values already replaced by <code>mk_rccm3.pro</code>.</p></li>
<li><p><code>rccm_3 {BYTE array} [O]:</code> An array containing the upgraded <span class="smallcaps">RCCM</span> product for the 9 camera files where most if not all of the missing values are replaced by reasonable estimates of the local cloudiness.</p></li>
<li><p><code>n_miss_3 {LONG array} [O]:</code> An array reporting how many missing values (<code>0B</code>) remain in each of these 9 cloud masks.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>VERBOSE = verbose {INT} [I] (Default value: 0):</code> Flag to enable (&gt; 0) or skip (0) outputting messages on the console:</p>
<ul>
<li><p>If <code>verbose &gt; 0</code>, messages inform the user about progress in the execution of time-consuming routines, or the location of output files (e.g., log, map, plot, etc.);</p></li>
<li><p>If <code>verbose &gt; 1</code>, messages record entering and exiting the routine; and</p></li>
<li><p>If <code>verbose &gt; 2</code>, messages provide additional information about intermediary results.</p></li>
</ul></li>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided in the call. The output positional parameters <code>rccm_3</code> and <code>n_miss_3</code> contain the upgraded cloud masks and the number of remaining missing values in each of them, respectively. The meaning of pixel values is as follows:</p>
<ul>
<li><p><code>0B</code>: Missing.</p></li>
<li><p><code>1B</code>: Cloud with high confidence.</p></li>
<li><p><code>2B</code>: Cloud with low confidence.</p></li>
<li><p><code>3B</code>: Clear with low confidence.</p></li>
<li><p><code>4B</code>: Clear with high confidence.</p></li>
<li><p><code>253B</code>: Obscured.</p></li>
<li><p><code>254B</code>: Edge.</p></li>
<li><p><code>255B</code>: Fill.</p></li>
</ul></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The output positional parameters <code>rccm_3</code> and <code>n_miss_3</code> may be inexistent, incomplete or incorrect.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: Input positional parameter <code>rccm_2</code> is invalid.</p></li>
<li><p>Error 200: An exception condition occurred in the function <code>path2str.pro</code>.</p></li>
<li><p>Error 210: An exception condition occurred in the function <code>orbit2str.peo</code>.</p></li>
<li><p>Error 220: An exception condition occurred in the function <code>block2str.pro</code>.</p></li>
<li><p>Error 500: An exception condition occurred in the function <code>repl_box.pro</code>.</p></li>
<li><p>Error 510: An exception condition occurred in the function <code>repl_box.pro</code>.</p></li>
<li><p>Error 520: An exception condition occurred in the function <code>repl_box.pro</code>.</p></li>
<li><p>Error 530: An exception condition occurred in the function <code>repl_box.pro</code>.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>block2str.pro</code></p></li>
<li><p><code>is_numeric.pro</code></p></li>
<li><p><code>orbit2str.pro</code></p></li>
<li><p><code>path2str.pro</code></p></li>
<li><p><code>repl_box.pro</code></p></li>
<li><p><code>set_misr_specs.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> By default, this function calls the function <code>repl_box.pro</code> with the optional keyword parameter <code>VERBOSE</code> set to 0, irrespective of the value inherited from the calling routine, because the latter is called individually for each and every missing pixel.</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>[See the outcome(s) generated by fix_rccm.pro]</code></pre></li>
<li><p><strong>References:</strong></p>
<ul>
<li><p>Michel Verstraete, Linda Hunt, Hugo De Lemos and Larry Di Girolamo (2019) <em>Replacing Missing Values in the Standard MISR Radiometric Camera-by-Camera Cloud Mask (RCCM) Data Product</em>, <code>Earth System Science Data Discussions</code>, Vol. 2019, p. 1&#8211;18, available from <a href="https://www.earth-syst-sci-data-discuss.net/essd-2019-77/" class="uri">https://www.earth-syst-sci-data-discuss.net/essd-2019-77/</a> (DOI: 10.5194/essd-2019-77).</p></li>
</ul></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2018&#8211;08&#8211;08: Version 0.8 &#8212; Original routines to manipulate <span class="smallcaps">MISR</span> <span class="smallcaps">RCCM</span> data products provided by Linda Hunt.</p></li>
<li><p>2018&#8211;12&#8211;23: Version 0.9 &#8212; Initial release: This function and those it depends on supersede all previous routines dealing with <span class="smallcaps">MISR</span> <span class="smallcaps">RCCM</span> data products.</p></li>
<li><p>2018&#8211;12&#8211;30: Version 1.0 &#8212; Initial public release.</p></li>
<li><p>2019&#8211;01&#8211;30: Version 1.1 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;02&#8211;02: Version 1.2 &#8212; Delete unused variable <code>pob_str</code>.</p></li>
<li><p>2019&#8211;02&#8211;05: Version 1.3 &#8212; Reorganize the <span class="smallcaps">MISR</span> <span class="smallcaps">RCCM</span> functions.</p></li>
<li><p>2019&#8211;02&#8211;18: Version 2.00 &#8212; Implement new algorithm (multiple scans of the input cloud mask) to minimize artifacts in the filled areas.</p></li>
<li><p>2019&#8211;02&#8211;27: Version 2.01 &#8212; New improved algorithm, capable of dealing with cases where most values are missing within a <span class="smallcaps">Block</span>, as long as values are not missing in neighboring cameras, rename this function from <code>mk_rccm_3</code> to <code>mk_rccm3</code>, and update the documentation.</p></li>
<li><p>2019&#8211;03&#8211;28: Version 2.10 &#8212; Update the handling of the optional input keyword parameter <code>VERBOSE</code> and generate the software version consistent with the published documentation.</p></li>
<li><p>2019&#8211;05&#8211;07: Version 2.15 &#8212; Software version described in the preprint published in ESSD Discussions mentioned above.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the use of <code>verbose</code> and the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
</ul></li>
</ul>
<h2>plot_rccm_miss</h2>
<ul>
<li><p><strong>Purpose:</strong> This function generates a time series plot of the number of missing <span class="smallcaps">RCCM</span> values found in the 9 cameras of all available <span class="smallcaps">Orbits</span> for the <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span> and <span class="smallcaps">Block</span> specified in the file name <code>in_fspec</code>, which is assumed to have been generated by the function <code>count_rccm_miss.pro</code>.</p></li>
<li><p><strong>Algorithm:</strong> This function reads the file provided by the input positional parameter <code>in_fspec</code> and saves the time series plot of the total number of missing <span class="smallcaps">RCCM</span> values for each processed <span class="smallcaps">Orbit</span>. By default, this plot is saved in the same folder as this input file. If the optional keyword parameter <code>OUT_FOLDER</code> is specified, it supersedes the default directory and the plot is saved in that folder instead. If the optional keyword parameter <code>SEMI_LOG</code> is set, then two plots are generated: one with a linear and one with a logarithmic scale on the <code>Y</code> axis. In this latter case, the minimum number of missing values for the purpose of plotting is set to <code>1</code>. The name(s) of the plot file(s) is(are) similar to the name of the input file, and include an extra field to indicate whether the plot is linear (<code>_lin</code>) or semi-logarithmic (<code>_slog</code>); the plot file extension(s) is(are) <code>.png</code>.</p></li>
<li><p><strong>Syntax:</strong> <code>rc = plot_rccm_miss(in_fspec, $</code><br />
<code>SEMI_LOG = semi_log, OUT_FILE = out_file, $</code><br />
<code>VERBOSE = verbose, DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>in_fspec {STRING} [I]:</code> The full file specification (path and name) of the file containing the results generated by the function <code>count_rccm_miss.pro</code>.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>SEMI_LOG = semi_log {STRING} [I] (Default value: 0)</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) generating the semi-logarithmic plot of the time series.</p></li>
<li><p><code>OUT_FOLDER = out_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the folder containing the output file(s).</p></li>
<li><p><code>VERBOSE = verbose {INT} [I] (Default value: 0):</code> Flag to enable (&gt; 0) or skip (0) outputting messages on the console:</p>
<ul>
<li><p>If <code>verbose &gt; 0</code>, messages inform the user about progress in the execution of time-consuming routines, or the location of output files (e.g., log, map, plot, etc.);</p></li>
<li><p>If <code>verbose &gt; 1</code>, messages record entering and exiting the routine; and</p></li>
<li><p>If <code>verbose &gt; 2</code>, messages provide additional information about intermediary results.</p></li>
</ul></li>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided in the call. The time series plot(s) of the missing RCCM values is(are) saved in the default or specified folder.</p></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The time series plot(s) of the missing RCCM values may be inexistent, incomplete or incorrect.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: The input positional parameter <code>in_fspec</code> is not of type STRING.</p></li>
<li><p>Error 300: The input file <code>in_fspec</code> is not found, not a regular file or not readable.</p></li>
<li><p>Error 310: The The structure of the input filename <code>in_fspec</code> is not recognized.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>is_numeric.pro</code></p></li>
<li><p><code>is_readable_file.pro</code></p></li>
<li><p><code>is_string.pro</code></p></li>
<li><p><code>set_year_range.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> This function assumes that the input data file <code>in_fspec</code> was generated by the function <code>count_rccm_miss.pro</code>, and therefore to the particular output format specified in that function.</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>IDL&gt; in_fspec = &#39;~/MISR_HR/Outcomes/GM-P168-B110/
   Num_RCCM_miss_P168-B110_2000-03-24_2018-05-29.txt&#39;
IDL&gt; semi_log = 1
IDL&gt; rc = plot_rccm_miss(in_fspec, SEMI_LOG = semi_log, $
   VERBOSE = verbose, DEBUG = debug, EXCPT_COND = excpt_cond)
The linear time series plot has been saved in
   ~/MISR_HR/Outcomes/GM-P168-B110/
   Num_RCCM_miss_P168-B110_2000-03-24_2018-05-29_lin.png
The semi-logarithmic time series plot has been saved in
   ~/MISR_HR/Outcomes/GM-P168-B110/
   Num_RCCM_miss_P168-B110_2000-03-24_2018-05-29_slog.png</code></pre></li>
<li><p><strong>References:</strong></p>
<ul>
<li><p>Michel Verstraete, Linda Hunt, Hugo De Lemos and Larry Di Girolamo (2019) <em>Replacing Missing Values in the Standard MISR Radiometric Camera-by-Camera Cloud Mask (RCCM) Data Product</em>, <code>Earth System Science Data Discussions</code>, Vol. 2019, p. 1&#8211;18, available from <a href="https://www.earth-syst-sci-data-discuss.net/essd-2019-77/" class="uri">https://www.earth-syst-sci-data-discuss.net/essd-2019-77/</a> (DOI: 10.5194/essd-2019-77).</p></li>
</ul></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2019&#8211;05&#8211;01: Version 1.0 &#8212; Initial release.</p></li>
<li><p>2019&#8211;05&#8211;06: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;05&#8211;07: Version 2.15 &#8212; Software version described in the preprint published in ESSD Discussions mentioned above.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the use of <code>verbose</code> and the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
</ul></li>
</ul>
<h2>repl_box</h2>
<ul>
<li><p><strong>Purpose:</strong> This function suggests to replace the missing value (<code>0B</code>) located at coordinates <code>[sample, line]</code> within the 2-D input positional parameter <code>array</code> by a suitable value established from an analysis of its valid neighbors within a square sub-window of <code>(2 \times box_inc) + 1</code> pixels on the side.</p></li>
<li><p><strong>Algorithm:</strong> This function assumes that the input positional parameter <code>array</code> is of type <code>BYTE</code>, is dimensioned <code>[512, 128]</code>, and contains <span class="smallcaps">MISR</span> <span class="smallcaps">RCCM</span> data, where individual element values can be <code>0B</code> (indicating missing data), lie within the range <code>[1B, 4B]</code> (indicating valid data: <code>1B</code> = cloudy with high confidence, <code>2B</code> = cloudy with low confidence, <code>3B</code> = clear with low confidence, and <code>4B</code> = clear with high confidence), or take on values larger than <code>250</code> (indicating unobservable pixels, e.g., obscured by topography or outside the swath of the instrument).<br />
The function (1) inspects a sub-window of <code>(2 \times box_inc) + 1</code> by <code>(2 \times box_inc) + 1</code> values, centred on the presumed missing pixel, and possibly trimmed to exclude elements lying outside the bounds of the <code>array</code>, (2) computes statistics on the values of the valid neighbors within that sub-window, and (3) proposes a reasonable non-null replacement value if at least <code>min_num_required</code> of those neighbors are valid (i.e., are themselves not missing and not flagged with values larger than <code>250</code>).<br />
The return code of the function indicates which decision rule has been applied, and the suggested replacement value for the missing pixel depends upon basic non-parametric statistics on the frequencies of appearance among valid neighbors of the missing value. Negative return codes refer to situations in which no replacement value for the missing pixel is proposed. Let <code>min</code>, <code>med</code> and <code>max</code> be the minimum, the median and the maximum values of the valid neighbors of the presumed missing value within the sub-window:</p>
<ul>
<li><p>If <code>rc = -3</code>: No replacement value is suggested because the pixel at the specified line and sample position within the input positional parameter <code>array</code> is not a missing value (<code>0B</code>).</p></li>
<li><p>If <code>rc = -2</code>: No replacement value is suggested as fewer than <code>min_num_required</code> valid neighboring values (not counting those that might fall outside the <code>array</code>) are available for analysis.</p></li>
<li><p>If <code>rc = -1</code>: No replacement value is suggested because the optional keyword parameter <code>HOMOGENEOUS</code> is set and the neighbors of the missing pixels in the current sub-window are not homogeneous.</p></li>
<li><p>If <code>rc = 0</code>: All valid neighbors of the missing pixel have the same value; then <code>value</code> is that same value.</p></li>
<li><p>If <code>rc = 1</code>: <code>min = 1B</code>, <code>max = 2B</code>, and <code>med &lt; 1.5</code>; then <code>value = 1B</code>.</p></li>
<li><p>If <code>rc = 2</code>: <code>min = 1B</code>, <code>max = 2B</code>, and <code>1.5 \leq med</code>; then <code>value = 2B</code>.</p></li>
<li><p>If <code>rc = 3</code>: <code>min = 2B</code>, <code>max = 3B</code>, and <code>med &lt; 2.5</code>; then <code>value = 2B</code>.</p></li>
<li><p>If <code>rc = 4</code>: <code>min = 2B</code>, <code>max = 3B</code>, and <code>2.5 \leq med</code>; then <code>value = 3B</code>.</p></li>
<li><p>If <code>rc = 5</code>: <code>min = 3B</code>, <code>max = 4B</code>, and <code>med &lt; 3.5</code>; then <code>value = 3B</code>.</p></li>
<li><p>If <code>rc = 6</code>: <code>min = 3B</code>, <code>max = 4B</code>, and <code>3.5 \leq med</code>; then <code>value = 4B</code>.</p></li>
<li><p>If <code>rc = 7</code>: <code>min = 1B</code>, <code>max = 3B</code>, and <code>med &lt; 1.5</code>; then <code>value = 1B</code>.</p></li>
<li><p>If <code>rc = 8</code>: <code>min = 1B</code>, <code>max = 3B</code>, and <code>1.5 \leq med &lt; 2.5</code>; then <code>value = 2B</code>.</p></li>
<li><p>If <code>rc = 9</code>: <code>min = 1B</code>, <code>max = 3B</code>, and <code>2.5 \leq med</code>; then <code>value = 3B</code>.</p></li>
<li><p>If <code>rc = 10</code>: <code>min = 2B</code>, <code>max = 4B</code>, and <code>med &lt; 2.5</code>; then <code>value = 2B</code>.</p></li>
<li><p>If <code>rc = 11</code>: <code>min = 2B</code>, <code>max = 4B</code>, and <code>2.5 \leq med &lt; 3.5</code>; then <code>value = 3B</code>.</p></li>
<li><p>If <code>rc = 12</code>: <code>min = 2B</code>, <code>max = 4B</code>, and <code>3.5 \leq med</code>; then <code>value = 4B</code>.</p></li>
<li><p>If <code>rc = 13</code>: <code>min = 1B</code>, <code>max = 4B</code>, and <code>med &lt; 1.5</code>; then <code>value = 1B</code>.</p></li>
<li><p>If <code>rc = 14</code>: <code>min = 1B</code>, <code>max = 4B</code>, and <code>1.5 \leq med &lt; 2.5</code>; then <code>value = 2B</code>.</p></li>
<li><p>If <code>rc = 15</code>: <code>min = 1B</code>, <code>max = 4B</code>, and <code>2.5 \leq med &lt; 3.5</code>; then <code>value = 3B</code>.</p></li>
<li><p>If <code>rc = 16</code>: <code>min = 1B</code>, <code>max = 4B</code>, and <code>3.5 \leq med</code>; then <code>value = 4B</code>.</p></li>
<li><p>If <code>rc &gt; 99</code>: An exception condition has been detected while executing this function.</p></li>
</ul></li>
<li><p><strong>Syntax:</strong> <code>rc = repl_box(array, sample, line, box_inc, min_num_required, $</code><br />
<code>value, HOMOGENEOUS = homogeneous, VERBOSE = verbose, $</code><br />
<code>DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>array {BYTE array} [I]:</code> The 2-D input array containing missing values.</p></li>
<li><p><code>sample {INT} [I]:</code> The sample coordinate of the missing value in the 2-D <code>array</code>.</p></li>
<li><p><code>line {INT} [I]:</code> The line coordinate of the missing value in the 2-D <code>array</code>.</p></li>
<li><p><code>box_inc {INT} [I]:</code> The parameter controlling the size of the sub-window to consider (e.g., <code>1</code> for a <span class="math inline">3&#8197;&#215;&#8197;3</span> sub-window, <code>2</code> for a <span class="math inline">5&#8197;&#215;&#8197;5</span> sub-window), etc.</p></li>
<li><p><code>min_num_required {INT} [I]:</code> The minimum number of valid neighbors needed to choose the replacement value.</p></li>
<li><p><code>value {BYTE} [O]:</code> The proposed replacement value for the missing value.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>HOMOGENEOUS = homogeneous {INT} [I]:</code> Flag to enable (1) or skip (0) considering only cases where all neighbors take on identical values.</p></li>
<li><p><code>VERBOSE = verbose {INT} [I] (Default value: 0):</code> Flag to enable (&gt; 0) or skip (0) outputting messages on the console:</p>
<ul>
<li><p>If <code>verbose &gt; 0</code>, messages inform the user about progress in the execution of time-consuming routines, or the location of output files (e.g., log, map, plot, etc.);</p></li>
<li><p>If <code>verbose &gt; 1</code>, messages record entering and exiting the routine; and</p></li>
<li><p>If <code>verbose &gt; 2</code>, messages provide additional information about intermediary results.</p></li>
</ul></li>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns a value in the range <code>[0, 16]</code>, indicating which decision rule has been applied, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided in the call. The output positional parameter <code>value</code> contains the suggested replacement value for the missing pixel, if one could be determined. Negative return codes indicate that no replacement value can be suggested.</p></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code larger than <code>99</code>, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The output positional parameter <code>value</code> may be inexistent, incomplete or incorrect.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: Input positional parameter <code>array</code> is invalid.</p></li>
<li><p>Error 120: Input positional parameter <code>sample</code> is invalid.</p></li>
<li><p>Error 130: Input positional parameter <code>line</code> is invalid.</p></li>
<li><p>Error 140: Input positional parameter <code>box_inc</code> must be an <code>INTEGER</code>.</p></li>
<li><p>Error 150: Input positional parameter <code>box_inc</code> must be smaller than half the smallest dimension of <code>array</code>.</p></li>
<li><p>Error 160: Input positional parameter <code>min_num_required</code> must be an <code>INTEGER</code>.</p></li>
<li><p>Error 200: An unforeseen condition occurred in function <code>repl_box.pro</code>.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>is_array.pro</code></p></li>
<li><p><code>is_integer.pro</code></p></li>
<li><p><code>is_numeric.pro</code></p></li>
<li><p><code>percentile.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> This function is exclusively intended for use in the specific context of replacing missing values in the <span class="smallcaps">MISR</span> <span class="smallcaps">RCCM</span> data products, where the valid individual pixel values are limited to <code>[0B, 1B, 2B, 3B, 4B, 253B, 254B, 255B]</code>. Other functions in this package may add meaning to other intermediate values, such as <code>[253B, 254B]</code>, which are flags to indicate unretrievable values.</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>[See the outcome(s) generated by fix_rccm.pro]</code></pre></li>
<li><p><strong>References:</strong></p>
<ul>
<li><p>Michel Verstraete, Linda Hunt, Hugo De Lemos and Larry Di Girolamo (2019) <em>Replacing Missing Values in the Standard MISR Radiometric Camera-by-Camera Cloud Mask (RCCM) Data Product</em>, <code>Earth System Science Data Discussions</code>, Vol. 2019, p. 1&#8211;18, available from <a href="https://www.earth-syst-sci-data-discuss.net/essd-2019-77/" class="uri">https://www.earth-syst-sci-data-discuss.net/essd-2019-77/</a> (DOI: 10.5194/essd-2019-77).</p></li>
</ul></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2019&#8211;02&#8211;04: Version 1.0 &#8212; Initial release, this function supersedes the former functions <code>repl_box3.pro</code> and <code>repl_box5.pro</code>; it implements the most current coding and documentation standards.</p></li>
<li><p>2019&#8211;02&#8211;05: Version 1.1 &#8212; Implement new algorithm (multiple scans of the input cloud mask) to minimize artifacts in the filled areas.</p></li>
<li><p>2019&#8211;02&#8211;18: Version 2.00 &#8212; Implement new algorithm (multiple scans of the input cloud mask) to minimize artifacts in the filled areas.</p></li>
<li><p>2019&#8211;03&#8211;28: Version 2.10 &#8212; Update the handling of the optional input keyword parameter <code>VERBOSE</code> and generate the software version consistent with the published documentation.</p></li>
<li><p>2019&#8211;05&#8211;07: Version 2.15 &#8212; Software version described in the preprint published in ESSD Discussions mentioned above.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the use of <code>verbose</code> and the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
</ul></li>
</ul>
<h2>set_rccm_folder</h2>
<ul>
<li><p><strong>Purpose:</strong> This function sets the path to the folder containing the <span class="smallcaps">MISR</span> <span class="smallcaps">RCCM</span> files for the specified <span class="smallcaps">Path</span>.</p></li>
<li><p><strong>Algorithm:</strong> By default, this function sets the path to the folder containing the <span class="smallcaps">MISR</span> <span class="smallcaps">RCCM</span> files according to the settings included in the function <code>set_roots_vers</code>; the optional input keyword parameter <code>rccm_folder</code> overrides this setting. The function also checks that this folder is available for reading.</p></li>
<li><p><strong>Syntax:</strong> <code>rc = set_rccm_folder(misr_path, rccm_fpath, n_rccm_files, $</code><br />
<code>RCCM_FOLDER = rccm_folder, RCCM_VERSION = rccm_version, $</code><br />
<code>VERBOSE = verbose, DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>misr_path {INT} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span> number.</p></li>
<li><p><code>rccm_fpath {STRING} [O]:</code> The path to the folder containing the <span class="smallcaps">MISR</span> <span class="smallcaps">RCCM</span> files for the specified <span class="smallcaps">Path</span>.</p></li>
<li><p><code>n_rccm_files {LONG} [O]:</code> The number of <span class="smallcaps">RCCM</span> files residing in the <code>rccm_folder</code>.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>RCCM_FOLDER = rccm_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the folder containing the <span class="smallcaps">MISR</span> <span class="smallcaps">RCCM</span> files, if they are not located in the default location.</p></li>
<li><p><code>RCCM_VERSION = rccm_version {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The <span class="smallcaps">MISR</span> <span class="smallcaps">RCCM</span> version identifier to use instead of the default value.</p></li>
<li><p><code>VERBOSE = verbose {INT} [I] (Default value: 0):</code> Flag to enable (&gt; 0) or skip (0) outputting messages on the console:</p>
<ul>
<li><p>If <code>verbose &gt; 0</code>, messages inform the user about progress in the execution of time-consuming routines, or the location of output files (e.g., log, map, plot, etc.);</p></li>
<li><p>If <code>verbose &gt; 1</code>, messages record entering and exiting the routine; and</p></li>
<li><p>If <code>verbose &gt; 2</code>, messages provide additional information about intermediary results.</p></li>
</ul></li>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided in the call. The output positional parameter <code>rccm_fpath</code> contains the the path to the folder containing the <span class="smallcaps">MISR</span> <span class="smallcaps">RCCM</span> files for the specified <span class="smallcaps">Path</span>.</p></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The output positional parameter <code>rccm_fpath</code> may be undefined, incomplete or incorrect.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: The input positional parameter <code>misr_path</code> is invalid.</p></li>
<li><p>Error 199: An exception condition occurred in <code>set_roots_vers.pro</code>.</p></li>
<li><p>Error 200: An exception condition occurred in function <code>path2str.pro</code>.</p></li>
<li><p>Error 299: The computer is not recognized and the optional input keyword parameter <code>rccm_folder</code> is not specified.</p></li>
<li><p>Error 300: The folder <code>rccm_path</code> exists but is unreadable.</p></li>
<li><p>Error 310: The folder <code>rccm_path</code> does not contain any <span class="smallcaps">RCCM</span> files.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>chk_misr_path.pro</code></p></li>
<li><p><code>force_path_sep.pro</code></p></li>
<li><p><code>is_numeric.pro</code></p></li>
<li><p><code>is_readable_file.pro</code></p></li>
<li><p><code>path2str.pro</code></p></li>
<li><p><code>set_roots_vers.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong> None.</p></li>
<li><p><strong>Examples:</strong></p>
<pre><code>IDL&gt; misr_path = 168
IDL&gt; rccm_folder = &#39;&#39;
IDL&gt; rccm_version = &#39;&#39;
IDL&gt; rc = set_rccm_folder(misr_path, rccm_fpath, $
   n_rccm_files, RCCM_FOLDER = rccm_folder, $
   RCCM_VERSION = rccm_version, VERBOSE = verbose, $
   DEBUG = debug, EXCPT_COND = excpt_cond)
IDL&gt; PRINT, rc
       0</code></pre></li>
<li><p><strong>References:</strong></p>
<ul>
<li><p>Michel Verstraete, Linda Hunt, Hugo De Lemos and Larry Di Girolamo (2019) <em>Replacing Missing Values in the Standard MISR Radiometric Camera-by-Camera Cloud Mask (RCCM) Data Product</em>, <code>Earth System Science Data Discussions</code>, Vol. 2019, p. 1&#8211;18, available from <a href="https://www.earth-syst-sci-data-discuss.net/essd-2019-77/" class="uri">https://www.earth-syst-sci-data-discuss.net/essd-2019-77/</a> (DOI: 10.5194/essd-2019-77).</p></li>
</ul></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2019&#8211;05&#8211;05: Version 1.0 &#8212; Initial release.</p></li>
<li><p>2019&#8211;05&#8211;06: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;05&#8211;07: Version 2.15 &#8212; Software version described in the preprint published in ESSD Discussions mentioned above.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the use of <code>verbose</code> and the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
</ul></li>
</ul>
</body>
</html>
